(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{196:function(e,t){},301:function(e,t,n){},321:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},400:function(e,t,n){},811:function(e,t,n){},812:function(e,t,n){},813:function(e,t,n){},814:function(e,t,n){},815:function(e,t,n){},816:function(e,t,n){},817:function(e,t,n){},818:function(e,t,n){},819:function(e,t,n){},820:function(e,t,n){},821:function(e,t,n){},825:function(e,t,n){},826:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(20),s=n.n(a),i=n(8),o=n(39),l=n(3),u=(n(301),n(859)),d=n(865),j=n(867),b=n(868),h=n(869),p=n(870),f=n(271),O=n.n(f),m=n(884),x=n(883),v=n(864),g=n(862),N=n(27),w=n(67),y=n(282),C=n(885),k=n(284),I=n(890),S=n(887),_=n(888),E=n(866),L=n(30),P=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:!0};case"FOLLOW":return Object(l.a)(Object(l.a)({},e),{},{user:Object(l.a)(Object(l.a)({},e.user),{},{followings:[].concat(Object(o.a)(e.user.followings),[t.payload])})});case"UNFOLLOW":return Object(l.a)(Object(l.a)({},e),{},{user:Object(l.a)(Object(l.a)({},e.user),{},{followings:e.user.followings.filter((function(e){return e!==t.payload}))})});case"UPDATE":return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case"LOGOUT":return{user:null,isFetching:!1,error:!1};default:return e}},U=n(1),A={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},T=Object(c.createContext)(A),F=function(e){var t=e.children,n=Object(c.useReducer)(P,A),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){localStorage.setItem("user",JSON.stringify(a.user))}),[a.user]),Object(U.jsx)(T.Provider,{value:{user:a.user,isFetching:a.isFetching,error:a.error,dispatch:s},children:t})},R=function(e,t){switch(t.type){case"CHANGE_THEME":return{theme:t.payload};default:return e}},D={theme:localStorage.getItem("theme")||"light"},B=Object(c.createContext)(D),M=function(e){var t=e.children,n=Object(c.useReducer)(R,D),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(U.jsx)(B.Provider,{value:{theme:a.theme,dispatch:s},children:t})},K=function(e){return{type:"CHANGE_THEME",payload:e}},H=n(12),V=n.n(H),W=n(23),z=n(35),G=n.n(z),q="https://k5gxjlwjl0.execute-api.ap-south-1.amazonaws.com/posts",J="https://2r0sg4bxg5.execute-api.ap-south-1.amazonaws.com/users",Y="https://95rv9rmrxi.execute-api.ap-south-1.amazonaws.com/conversations",X="https://5kq2t3b9fi.execute-api.ap-south-1.amazonaws.com/messages",Q=function(){var e=Object(W.a)(V.a.mark((function e(t,n){var c,r,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"LOGIN_START"}),e.prev=1,e.next=4,G.a.post("".concat(J,"/login"),t);case 4:c=e.sent,n({type:"LOGIN_SUCCESS",payload:c.data}),y.b.success("Logged in successfully."),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),n({type:"LOGIN_FAILURE",payload:e.t0}),y.b.error(null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(W.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.post("".concat(J,"/register"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(J,"?userId=")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(J,"?username=")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(J,"/friends/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(J,"/friendsByUserName/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(W.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.put("".concat(J,"/").concat(t,"/unfollow"),{userId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=Object(W.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.put("".concat(J,"/").concat(t,"/follow"),{userId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ae=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.put("".concat(J,"/").concat(t.userId),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(Y,"/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(X,"/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.post("".concat(X),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(W.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(Y,"/find/").concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ue=function(){var e=Object(W.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(J,"/search?q=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(W.a)(V.a.mark((function e(t){var n,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,c=t.payload,e.next=3,G.a.put("".concat(q,"/").concat(n,"/like"),c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(W.a)(V.a.mark((function e(t){var n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,t.userId,e.next=3,G.a.delete("".concat(q,"/").concat(n));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=Object(c.useState)(0),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(c.useLayoutEffect)((function(){var e=function(){r(window.innerWidth)};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[]),n},he=function(e,t){switch(t.type){case"SET_ONLINE_USERS":return Object(l.a)(Object(l.a)({},e),{},{onlineUsers:t.payload});case"SET_ARRIVAL_MESSAGE":return Object(l.a)(Object(l.a)({},e),{},{arrivalMessage:t.payload});case"SET_NEW_CONVERSATION":return Object(l.a)(Object(l.a)({},e),{},{newConversation:t.payload});default:return e}},pe={onlineUsers:[],arrivalMessage:null,newConversation:null},fe=Object(c.createContext)(pe),Oe=function(e){var t=e.children,n=Object(c.useReducer)(he,pe),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(U.jsx)(fe.Provider,{value:{onlineUsers:a.onlineUsers,arrivalMessage:a.arrivalMessage,newConversation:a.newConversation,dispatch:s},children:t})};n(321);function me(e){var t=e.user,n=e.online,c=void 0===n||n;return Object(U.jsxs)("li",{className:"rightbarFriend",children:[Object(U.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(U.jsx)("img",{className:"rightbarProfileImg",src:""!==t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(U.jsx)("span",{className:c?"rightbarOnline":"rightbarOffline"})]}),Object(U.jsx)("span",{className:"rightbarUsername",children:t.username})]})}var xe=n(280),ve=function(){var e=Object(c.useContext)(T).user,t=Object(c.useContext)(fe).dispatch,n=Object(c.useRef)();return Object(c.useEffect)((function(){e&&(n.current=Object(xe.a)("https://socket.docplus.online/chat"),n.current.emit("addUser",null===e||void 0===e?void 0:e._id),n.current.on("getMessage",(function(e){var n=e.senderId,c=e.text;t({type:"SET_ARRIVAL_MESSAGE",payload:{sender:n,text:c,createdAt:Date.now()}})})),n.current.on("getConversation",(function(e){var n=e.senderId,c=e.conversation;t(function(e){return{type:"SET_NEW_CONVERSATION",payload:e}}({senderId:n,conversation:c}))})))}),[e,t]),{socket:n}};function ge(){var e=Object(c.useContext)(T),t=e.user,n=e.dispatch,r=Object(c.useContext)(fe).onlineUsers,a=ve().socket,s=Object(c.useContext)(B),f=s.theme,P=s.dispatch,A=Object(N.g)(),F=Object(c.useState)([]),R=Object(i.a)(F,2),D=R[0],M=R[1],H=Object(c.useState)(!1),V=Object(i.a)(H,2),W=V[0],z=V[1],G=Object(c.useState)([]),q=Object(i.a)(G,2),J=q[0],Y=q[1],X=Object(c.useState)([]),Q=Object(i.a)(X,2),Z=Q[0],$=Q[1],ee=Object(c.useState)(!0),ne=Object(i.a)(ee,2),ce=ne[0],re=ne[1],ae=be();Object(c.useEffect)((function(){re(!0),te(t._id).then((function(e){Y(e.data),re(!1)})).catch((function(e){console.log(e),re(!1)}))}),[t._id]),Object(c.useEffect)((function(){$(J.filter((function(e){return null===r||void 0===r?void 0:r.includes(e._id)})))}),[r,J]);var se=function(){z(!1)},ie=function(){localStorage.removeItem("user"),n({type:"LOGOUT"}),a.current.emit("logoutUser",t._id),y.b.success("Logout successfully."),A.push("/")},oe=Object(U.jsxs)(C.a,{children:[Object(U.jsx)(C.a.Item,{children:Object(U.jsx)(w.b,{to:"/profile/".concat(t.username),children:"Profile"})},"Profile"),Object(U.jsx)(C.a.Item,{children:Object(U.jsx)("div",{onClick:ie,children:"Logout"})},"Logout")]});return Object(U.jsxs)("div",{className:"topbarContainer",children:[Object(U.jsx)("div",{className:"topbarLeft",children:Object(U.jsx)(w.b,{to:"/",style:{textDecoration:"none"},children:Object(U.jsx)("span",{className:"logo",children:"ViaChat"})})}),Object(U.jsx)("div",{className:"topbarCenter",children:Object(U.jsxs)("div",{className:"searchbar",children:[Object(U.jsx)(u.a,{className:"searchIcon"}),Object(U.jsx)(m.a,{freeSolo:!0,id:"free-solo-2-demo",options:D,PaperComponent:function(e){var t=e.children;return Object(U.jsx)(g.a,{style:"dark"===f?{background:"#0a0c0e",border:"1px solid #181111"}:{},children:t})},getOptionLabel:function(e){return e.username},renderOption:function(e){return Object(U.jsxs)("div",{className:"searchSuggestions",onClick:function(){return A.push("/profile/".concat(e.username))},children:[Object(U.jsx)("div",{className:"profilePicture",children:Object(U.jsx)("img",{src:e.profilePicture?e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"topbarImg"})}),Object(U.jsxs)("div",{className:"searchContent",children:[Object(U.jsx)("div",{className:"email",children:e.email}),Object(U.jsx)("div",{className:"username",children:e.username})]})]})},renderInput:function(e){return Object(U.jsx)(x.a,Object(l.a)(Object(l.a)({},e),{},{label:ae>340?"Search for friend (by username)":"Search for friend",margin:"normal",onChange:function(e){return function(e){var t=e.target.value;t?ue(t).then((function(e){M(e.data)})).catch((function(e){console.log(e),M([])})):M([])}(e)},InputProps:Object(l.a)(Object(l.a)({},e.InputProps),{},{type:"search"})}))}})]})}),Object(U.jsxs)("div",{className:"topbarRight",children:[Object(U.jsxs)("div",{className:"topbarLinks",children:[Object(U.jsx)("span",{className:"topbarLink",onClick:function(){return A.push("/")},children:"Homepage"}),Object(U.jsx)("span",{className:"topbarLink",onClick:function(){return A.push("/profile/".concat(t.username))},children:"Timeline"})]}),Object(U.jsxs)("div",{className:"d-flex align-items-center",children:[Object(U.jsxs)("div",{className:"topbarIcons",children:[Object(U.jsx)("div",{className:"topbarIconItem",onClick:function(){return A.push("/messenger")},children:Object(U.jsx)(d.a,{})}),Object(U.jsx)("div",{className:"topbarIconItem",children:Object(U.jsx)(k.a,{overlayStyle:{whiteSpace:"pre-line",fontSize:13},title:"Dark theme",placement:"bottom",children:Object(U.jsx)(I.a,{size:"small",checked:"dark"===f,onChange:function(e){P(K(e?"dark":"light")),localStorage.setItem("theme",e?"dark":"light")}})})})]}),Object(U.jsxs)("span",{className:"helloUserText",children:["Hello, ",null===t||void 0===t?void 0:t.username]}),Object(U.jsx)(S.a,{overlay:oe,children:Object(U.jsx)("img",{src:t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"topbarImg"})})]})]}),Object(U.jsx)("div",{className:"menuIcon",children:Object(U.jsx)(v.a,{onClick:function(){z(!0)},children:Object(U.jsx)(O.a,{style:{color:"#fff"}})})}),Object(U.jsxs)(_.a,{width:ae>370?320:"100%",placement:"right",visible:W,onClose:se,children:[Object(U.jsxs)("div",{className:"profileContainer",children:[Object(U.jsx)("img",{src:t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",style:{width:80,height:80},alt:"",className:"topbarImg"}),Object(U.jsxs)("div",{className:"profileContent ms-2",children:[Object(U.jsxs)("h5",{className:"profileUsername",children:["Hello, ",Object(U.jsx)("br",{})," ",Object(U.jsxs)("strong",{children:["@",t.username]})]}),Object(U.jsx)(w.b,{to:"/profile/".concat(t.username),children:"Visit your profile"})]})]}),Object(U.jsx)(E.a,{}),Object(U.jsxs)("div",{className:"profileLinks",children:[Object(U.jsxs)("div",{className:"profileLink",children:[Object(U.jsx)(j.a,{}),Object(U.jsx)("span",{onClick:function(){return A.push("/")},children:"Homepage"})]}),Object(U.jsxs)("div",{className:"profileLink",children:[Object(U.jsx)(b.a,{}),Object(U.jsx)("span",{onClick:function(){return A.push("/profile/".concat(t.username))},children:"Timeline"})]}),Object(U.jsxs)("div",{className:"profileLink",children:[Object(U.jsx)(h.a,{}),Object(U.jsx)("span",{onClick:function(){return A.push("/messenger")},children:"Messenger"})]}),Object(U.jsxs)("div",{className:"profileLink",children:[Object(U.jsx)(p.a,{}),Object(U.jsx)("span",{onClick:ie,children:"Logout"})]}),Object(U.jsx)(E.a,{}),Object(U.jsxs)("div",{className:"profileLink mt-2",children:[Object(U.jsx)(I.a,{checked:"dark"===f,onChange:function(e){P(K(e?"dark":"light")),localStorage.setItem("theme",e?"dark":"light")}}),"Toggle theme"]})]}),Object(U.jsx)(E.a,{}),Object(U.jsx)("h5",{className:"profileUsername mb-3",children:"Your friends"}),ce?Object(o.a)(Array(2).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})):J.map((function(e){var t,n=(t=e._id,Z.some((function(e){return e._id===t})));return Object(U.jsx)("div",{onClick:function(){se(),A.push("/messenger?q=".concat(e._id))},style:{cursor:"pointer"},children:Object(U.jsx)(me,{user:e,online:n},e._id)},e._id)}))]})]})}n(397);var Ne=n(871);n(398);function we(e){var t=e.user,n=Object(N.g)();return Object(U.jsxs)("li",{className:"sidebarFriend",onClick:function(){return n.push("/profile/"+t.username)},children:[Object(U.jsx)("img",{className:"sidebarFriendImg",src:""!==t.profilePicture?t.profilePicture.replace("s3.ap-south-1.amazonaws.com/social-app-assets","d225jocw4xhwve.cloudfront.net"):"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(U.jsx)("span",{className:"sidebarFriendName",children:t.username})]})}function ye(){var e=Object(c.useContext)(T).user,t=Object(N.g)(),n=Object(c.useState)([]),r=Object(i.a)(n,2),a=r[0],s=r[1],l=Object(c.useState)(!0),u=Object(i.a)(l,2),j=u[0],b=u[1];return Object(c.useEffect)((function(){b(!0),te(e._id).then((function(e){s(e.data),b(!1)})).catch((function(e){console.log(e),b(!1)}))}),[e]),Object(U.jsx)("div",{className:"sidebar",children:Object(U.jsxs)("div",{className:"sidebarWrapper",children:[Object(U.jsxs)("ul",{className:"sidebarList",children:[Object(U.jsxs)("li",{className:"sidebarListItem",onClick:function(){return t.push("/profile/".concat(e.username))},children:[Object(U.jsx)(Ne.a,{className:"sidebarIcon"}),Object(U.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(U.jsxs)("li",{className:"sidebarListItem",onClick:function(){return t.push("/messenger")},children:[Object(U.jsx)(d.a,{className:"sidebarIcon"}),Object(U.jsx)("span",{className:"sidebarListItemText",children:"Chats"})]})]}),Object(U.jsx)("hr",{className:"sidebarHr"}),Object(U.jsx)("ul",{className:"sidebarFriendList",children:j?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})):a.map((function(e){return Object(U.jsx)(we,{user:e},e._id)}))})]})})}n(399);var Ce=n(872),ke=n(174);function Ie(e){var t=e.post,n=e.fetchPosts,r=e.differentUser,a=void 0!==r&&r,s=e.index,o=Object(c.useState)(t.likes.length),l=Object(i.a)(o,2),u=l[0],d=l[1],j=Object(c.useState)(!1),b=Object(i.a)(j,2),h=b[0],p=b[1],f=Object(c.useState)({}),O=Object(i.a)(f,2),m=O[0],x=O[1],v=Object(c.useContext)(T).user,g=Object(N.g)();Object(c.useEffect)((function(){p(t.likes.includes(v._id))}),[v._id,t.likes]),Object(c.useEffect)((function(){(function(){var e=Object(W.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$(t.userId).then((function(e){x(e.data)})).catch((function(e){return console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.userId]);var k=function(){var e=Object(W.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:je({_id:t._id}).then((function(e){y.b.success("Post deleted successfully."),n()})).catch((function(e){y.b.error("Something went wrong!")}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=Object(U.jsx)(C.a,{children:Object(U.jsx)(C.a.Item,{children:Object(U.jsx)("span",{onClick:k,children:"Delete"})})});return Object(U.jsx)("div",{className:"post ".concat(a&&0===s?"firstPost":""),children:Object(U.jsxs)("div",{className:"postWrapper",children:[Object(U.jsxs)("div",{className:"postTop",children:[Object(U.jsxs)("div",{className:"postTopLeft",children:[Object(U.jsx)(w.b,{to:"/profile/".concat(m.username),children:Object(U.jsx)("img",{className:"postProfileImg",src:m.profilePicture?m.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""})}),Object(U.jsx)("span",{className:"postUsername",onClick:function(){return g.push("/profile/".concat(m.username))},children:m.username}),Object(U.jsx)("span",{className:"postDate",children:Object(ke.a)(t.createdAt)})]}),(null===t||void 0===t?void 0:t.userId)===(null===v||void 0===v?void 0:v._id)&&Object(U.jsx)("div",{className:"postTopRight",style:{cursor:"pointer"},children:Object(U.jsx)(S.a,{overlay:I,children:Object(U.jsx)(Ce.a,{})})})]}),Object(U.jsxs)("div",{className:"postCenter",children:[Object(U.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),t.img&&Object(U.jsx)("img",{className:"postImg",src:t.img,alt:""})]}),Object(U.jsx)("div",{className:"postBottom",children:Object(U.jsxs)("div",{className:"postBottomLeft",children:[Object(U.jsx)("img",{className:"likeIcon",src:"".concat("https://d225jocw4xhwve.cloudfront.net/","like.png"),onClick:function(){try{de({_id:t._id,payload:{userId:v._id}})}catch(e){}d(h?u-1:u+1),p(!h)},alt:""}),Object(U.jsxs)("span",{className:"postLikeCounter",children:[u," people like it"]})]})})]})})}n(400);var Se=n(873),_e=n(874),Ee=n(401);Ee.config={secretAccessKey:"aHOzpUp3nCoHyYL3rGRsejyjNPC94psK1nvUcgat",accessKeyId:"AKIA3JPVUL47F5NR5XMG",region:"ap-south-1"};var Le=new Ee.S3,Pe="social-app-assets",Ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};try{var n="".concat(null===e||void 0===e?void 0:e.name,"-").concat((new Date).getTime()),c={Bucket:Pe,Key:n,Expires:9e4,ContentType:e.type,ACL:"public-read"};Le.getSignedUrl("putObject",c,(function(c,r){if(c)return t(c);var a={headers:{"Content-Type":e.type}},s="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUBLIC_FOLDER:"https://d225jocw4xhwve.cloudfront.net/"}).CLOUDFRONT_ASSETS_URL||"https://d225jocw4xhwve.cloudfront.net","/").concat(n);G.a.put(r,e,a).then((function(){return t(!1,s)})).catch((function(e){return t(e)}))}))}catch(r){console.log({err:r})}};function Ae(e){var t=e.fetchPosts,n=Object(c.useContext)(T).user,r=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useState)(null),o=Object(i.a)(s,2),l=o[0],u=o[1],d=function(e){G.a.post(q,e).then((function(e){y.b.success("New Post Uploaded"),t()})).catch((function(e){y.b.error((null===e||void 0===e?void 0:e.data)||"Please try again later.")}))},j=function(){var e=Object(W.a)(V.a.mark((function e(t){var c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={userId:n._id,desc:r.current.value},l)try{Ue(l,(function(e,t){e?y.b.error((null===e||void 0===e?void 0:e.message)||"Please try again later."):(c.img=t,d(c))}))}catch(a){}else d(c);r.current.value="",u(null);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsx)("div",{className:"share",children:Object(U.jsxs)("div",{className:"shareWrapper",children:[Object(U.jsxs)("div",{className:"shareTop",children:[Object(U.jsx)("img",{className:"shareProfileImg",src:n.profilePicture?n.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(U.jsx)("textarea",{placeholder:"What's in your mind "+n.username+"?",className:"shareInput",ref:r})]}),Object(U.jsx)("hr",{className:"shareHr"}),l&&Object(U.jsxs)("div",{className:"shareImgContainer",children:[Object(U.jsx)("img",{className:"shareImg",src:URL.createObjectURL(l),alt:""}),Object(U.jsx)(Se.a,{className:"shareCancelImg",onClick:function(){u(null),a.current.value=null}})]}),Object(U.jsxs)("form",{className:"shareBottom",onSubmit:j,children:[Object(U.jsx)("div",{className:"shareOptions",children:Object(U.jsxs)("label",{htmlFor:"feedPost",className:"shareOption",children:[Object(U.jsx)(_e.a,{htmlColor:"tomato",className:"shareIcon"}),Object(U.jsx)("span",{className:"shareOptionText",children:"Photo or Video"}),Object(U.jsx)("input",{style:{display:"none"},type:"file",ref:a,id:"feedPost",accept:".png,.jpeg,.jpg",onChange:function(e){return u(e.target.files[0])}})]})}),Object(U.jsx)("button",{className:"shareButton",type:"submit",children:"Share"})]})]})})}n(811);function Te(e){var t=e.username,n=e.user,r=Object(c.useState)([]),a=Object(i.a)(r,2),s=a[0],l=a[1],u=Object(c.useState)(!0),d=Object(i.a)(u,2),j=d[0],b=d[1],h=Object(c.useContext)(T).user,p=function(){var e=Object(W.a)(V.a.mark((function e(){var n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b(!0),e.prev=1,!t){e.next=8;break}return e.next=5,G.a.get("".concat(q,"/profile/")+t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,G.a.get("".concat(q,"/timeline/")+h._id);case 10:e.t0=e.sent;case 11:n=e.t0,l(n.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}))),b(!1),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),b(!1);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){p()}),[t,h._id,n]),Object(U.jsx)("div",{className:"feed",children:Object(U.jsxs)("div",{className:"feedWrapper",children:[(!t||t===h.username)&&Object(U.jsx)(Ae,{fetchPosts:p}),j?Object(o.a)(Array(2).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"mt-3",children:[Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"ps-3",children:Object(U.jsx)(L.a,{count:2,width:200})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{width:100})})]}),Object(U.jsx)(L.a,{count:2}),Object(U.jsx)(L.a,{height:180}),Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"ps-3",children:Object(U.jsx)(L.a,{width:200})})]})]},t)})):s&&s.length>0?s.map((function(e,t){return Object(U.jsx)(Ie,{fetchPosts:p,post:e,index:t,differentUser:!!n&&(null===n||void 0===n?void 0:n._id)!==h._id},e._id)})):Object(U.jsxs)("h3",{className:"noPostHeading",children:[n&&(null===n||void 0===n?void 0:n._id)!==h._id?"@"+(null===n||void 0===n?void 0:n.username):"You"," ","have not post anything yet!"]})]})})}n(812);var Fe=n(875),Re=n(876),De=n(877),Be=n(42),Me=n(882),Ke=n(886),He=n(276),Ve=n(891);function We(e){var t=e.show,n=e.handleClose,r=e.handleSubmit,a=e.user,s=Object(c.useState)(!1),o=Object(i.a)(s,2),u=o[0],d=o[1],j=Object(c.useState)({firstName:"",lastName:"",city:""}),b=Object(i.a)(j,2),h=b[0],p=b[1];Object(c.useEffect)((function(){a&&p((function(e){return Object(l.a)(Object(l.a)({},e),a)}))}),[a]);return Object(U.jsxs)(Me.a,{show:t,onHide:n,children:[Object(U.jsx)(Me.a.Header,{closeButton:!0,children:Object(U.jsx)(Me.a.Title,{children:"User information"})}),Object(U.jsx)(Me.a.Body,{children:Object(U.jsxs)(Ke.a,{noValidate:!0,validated:u,onSubmit:function(e){var t=e.currentTarget;e.preventDefault(),!1===t.checkValidity()&&e.stopPropagation(),d(!0),r(h)},children:[Object(U.jsxs)(Ke.a.Group,{as:He.a,className:"mb-3",controlId:"firstName",children:[Object(U.jsx)(Ke.a.Label,{children:"First name"}),Object(U.jsx)(Ke.a.Control,{required:!0,type:"text",minLength:5,placeholder:"First name",name:"firstName",value:h.firstName,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(U.jsx)(Ke.a.Control.Feedback,{children:"Looks good!"}),Object(U.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid First name."})]}),Object(U.jsxs)(Ke.a.Group,{as:He.a,className:"mb-3",controlId:"lastName",children:[Object(U.jsx)(Ke.a.Label,{children:"Last name"}),Object(U.jsx)(Ke.a.Control,{required:!0,type:"text",minLength:5,placeholder:"Last name",name:"lastName",value:h.lastName,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(U.jsx)(Ke.a.Control.Feedback,{children:"Looks good!"}),Object(U.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid First name."})]}),Object(U.jsxs)(Ke.a.Group,{as:He.a,className:"mb-3",controlId:"city",children:[Object(U.jsx)(Ke.a.Label,{children:"City"}),Object(U.jsx)(Ke.a.Control,{name:"city",type:"text",placeholder:"City",required:!0,value:h.city,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(U.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid city."})]}),Object(U.jsxs)("div",{className:"d-flex",children:[Object(U.jsx)(Ve.a,{variant:"secondary",onClick:n,children:"Close"}),Object(U.jsx)(Ve.a,{variant:"primary",style:{marginLeft:"12px"},onClick:r,type:"submit",children:"Save Changes"})]})]})})]})}function ze(e){var t=e.user,n=e.onlineFriends,r=e.UpdateUserDetails,a=void 0===r?function(){}:r,s=e.loadingFriends,l=e.loadingUserDetails,u=void 0!==l&&l,j=e.mobileView,b=Object(c.useState)([]),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(N.g)(),m=Object(c.useContext)(T),x=m.user,v=m.dispatch,g=Object(c.useState)(x.followings.includes(null===t||void 0===t?void 0:t._id)),C=Object(i.a)(g,2),k=C[0],I=C[1];Object(c.useEffect)((function(){I(x.followings.includes(null===t||void 0===t?void 0:t._id))}),[x,t]),Object(c.useEffect)((function(){(function(){var e=Object(W.a)(V.a.mark((function e(){var n,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.username){e.next=13;break}return e.prev=1,e.next=4,ne(t.username);case 4:n=e.sent,f(n.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:e.next=23;break;case 13:return e.prev=13,e.next=16,te(null===x||void 0===x?void 0:x._id);case 16:c=e.sent,f(c.data),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(13),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[1,8],[13,20]])})));return function(){return e.apply(this,arguments)}})()()}),[null===x||void 0===x?void 0:x._id,t]);var S=function(){var e=Object(W.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{k?ce(t._id,x._id).then((function(e){y.b.success("User has been unfollowed."),v({type:"UNFOLLOW",payload:t._id})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")})):re(t._id,x._id).then((function(e){y.b.success("User has been followed."),v({type:"FOLLOW",payload:t._id})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")})),I(!k)}catch(n){}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("img",{className:"rightbarAd",src:"assets/ad.png",alt:""}),(null===n||void 0===n?void 0:n.length)>0&&Object(U.jsx)("h4",{className:"rightbarTitle",children:"Online Friends"}),Object(U.jsx)("ul",{className:"rightbarFriendList",children:s?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})):null===n||void 0===n?void 0:n.map((function(e){return Object(U.jsx)("div",{onClick:function(){return O.push("/messenger?q=".concat(e._id))},style:{cursor:"pointer"},children:Object(U.jsx)(me,{user:e},e._id)},e._id)}))})]})},E=function(){var e=Object(c.useState)(!1),n=Object(i.a)(e,2),r=n[0],s=n[1],o=function(){return s(!1)};return Object(U.jsxs)(U.Fragment,{children:[u?Object(U.jsxs)("div",{children:[Object(U.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{width:200,count:2})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{height:36})})]}),Object(U.jsx)(L.a,{count:3,width:200}),Object(U.jsx)(L.a,{count:6})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"d-flex align-items-center",children:[t.username!==x.username&&Object(U.jsxs)("button",{className:"rightbarFollowButton",onClick:S,children:[k?"Unfollow":"Follow",k?Object(U.jsx)(Fe.a,{}):Object(U.jsx)(Re.a,{})]}),k&&Object(U.jsx)("button",{className:"rightbarFollowButton ms-3",onClick:function(){return O.push("/messenger?q=".concat(null===t||void 0===t?void 0:t._id))},title:"Send Message",children:Object(U.jsx)(d.a,{})})]}),Object(U.jsxs)("div",{className:"profileEditContainer",children:[Object(U.jsxs)("div",{className:"d-flex flex-column",children:[Object(U.jsx)("h4",{className:"profileInfoName",children:Object(U.jsx)("strong",{children:t.username&&"@".concat(t.username)})}),Object(U.jsx)("h4",{className:"rightbarTitle",children:"User information"})]}),t.username===x.username&&Object(U.jsxs)("button",{className:"editButton",onClick:function(){return s(!0)},children:[Object(U.jsx)(De.a,{}),"Edit profile"]})]}),Object(U.jsxs)("div",{className:"rightbarInfo",children:[Object(U.jsxs)("div",{className:"rightbarInfoItem",children:[Object(U.jsx)("span",{className:"rightbarInfoKey",children:"First Name:"}),Object(U.jsx)("span",{className:"rightbarInfoValue",children:t.firstName||"N/A"})]}),Object(U.jsxs)("div",{className:"rightbarInfoItem",children:[Object(U.jsx)("span",{className:"rightbarInfoKey",children:"Last Name:"}),Object(U.jsx)("span",{className:"rightbarInfoValue",children:t.lastName||"N/A"})]}),Object(U.jsxs)("div",{className:"rightbarInfoItem",children:[Object(U.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(U.jsx)("span",{className:"rightbarInfoValue",children:t.city||"N/A"})]})]}),Object(U.jsx)("h4",{className:"rightbarTitle",children:"User friends"}),Object(U.jsx)("div",{className:"rightbarFollowings",children:p.map((function(e){return Object(U.jsx)(w.b,{to:"/profile/"+e.username,style:{textDecoration:"none"},children:Object(U.jsxs)("div",{className:"rightbarFollowing",children:[Object(U.jsx)("img",{src:e.profilePicture?e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(U.jsx)("span",{className:"rightbarFollowingName text-center",children:e.username})]})},e.username)}))})]}),Object(U.jsx)(We,{show:r,user:t,handleClose:o,handleSubmit:function(e){try{a(e,(function(e){e||o()}))}catch(t){console.log(t)}}})]})};return Object(U.jsx)("div",{className:j?"rightbarMobile":"rightbar",children:Object(U.jsx)("div",{className:"rightbarWrapper",children:t?Object(U.jsx)(E,{}):Object(U.jsx)(_,{})})})}n(813);function Ge(){var e=Object(N.g)(),t=Object(c.useContext)(T).user,n=Object(c.useContext)(fe).onlineUsers,r=Object(c.useState)([]),a=Object(i.a)(r,2),s=a[0],o=a[1],l=Object(c.useState)([]),u=Object(i.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!0),h=Object(i.a)(b,2),p=h[0],f=h[1];return Object(c.useEffect)((function(){t||e.push("/")}),[t,e]),Object(c.useEffect)((function(){f(!0),te(t._id).then((function(e){o(e.data),f(!1)})).catch((function(e){console.log(e),f(!1)}))}),[t]),Object(c.useEffect)((function(){j(s.filter((function(e){return null===n||void 0===n?void 0:n.includes(e._id)})))}),[n,s]),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(ge,{}),Object(U.jsxs)("div",{className:"homeContainer",children:[Object(U.jsx)(ye,{}),Object(U.jsx)(Te,{}),Object(U.jsx)(ze,{onlineFriends:d,friends:s,loadingFriends:p})]})]})}n(814);var qe=n(878);function Je(){var e=Object(N.g)(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useContext)(T),a=r.isFetching,s=r.dispatch;return Object(U.jsx)("div",{className:"login",children:Object(U.jsxs)("div",{className:"loginWrapper row align-items-center",children:[Object(U.jsxs)("div",{className:"loginLeft col-md-6",children:[Object(U.jsx)("h3",{className:"loginLogo",children:"ViaChat"}),Object(U.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on ViaChat."})]}),Object(U.jsx)("div",{className:"loginRight col-md-6",children:Object(U.jsxs)("form",{className:"loginBox",onSubmit:function(e){e.preventDefault(),Q({email:t.current.value,password:n.current.value},s)},children:[Object(U.jsx)("input",{placeholder:"Email",type:"email",name:"email",required:!0,className:"loginInput",ref:t}),Object(U.jsx)("input",{placeholder:"Password",type:"password",name:"password",required:!0,minLength:"6",className:"loginInput",ref:n}),Object(U.jsx)("button",{className:"loginButton",type:"submit",disabled:a,children:a?Object(U.jsx)(qe.a,{color:"white",size:"20px"}):"Log In"}),Object(U.jsx)("button",{className:"loginRegisterButton",onClick:function(){return e.push("/")},disabled:a,children:a?Object(U.jsx)(qe.a,{color:"white",size:"20px"}):"Create a New Account"})]})})]})})}n(815);var Ye=n(880),Xe=n(879);function Qe(){var e=Object(c.useState)({}),t=Object(i.a)(e,2),n=t[0],r=t[1],a=be(),s=Object(c.useContext)(T),o=s.user,u=s.dispatch,d=Object(c.useState)({coverPicture:!1,profilePicture:!1}),j=Object(i.a)(d,2),b=j[0],h=j[1],p=Object(c.useState)(!1),f=Object(i.a)(p,2),O=f[0],m=f[1],x=Object(c.useState)([]),v=Object(i.a)(x,2),g=v[0],w=v[1],C=Object(N.i)().username;Object(c.useEffect)((function(){m(!0),function(){var e=Object(W.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ee(C).then((function(e){r(e.data)})).catch((function(e){return console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),m(!1)}),[C]),Object(c.useEffect)((function(){te(o._id).then((function(e){w(e.data)})).catch((function(e){return console.log(e)}))}),[o._id]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return[ae(Object(l.a)(Object(l.a)({},e),{},{userId:n._id})).then((function(e){var n;t(!1,e),r(e.data.data),u({type:"UPDATE",payload:e.data.data}),h({coverPicture:!1,profilePicture:!1}),y.b.success((null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||"Profile updated successfully.")})).catch((function(e){console.log(e)}))]},I=function(e,t){Ue(e,(function(e,n){e?y.b.error((null===e||void 0===e?void 0:e.message)||"Something went wrong!"):(h(Object(l.a)(Object(l.a)({},b),{},Object(Be.a)({},t,!0))),k(Object(l.a)(Object(l.a)({},o),{},Object(Be.a)({},t,n))))}))};return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(ge,{}),Object(U.jsxs)("div",{className:"profile",children:[Object(U.jsx)(ye,{friends:g}),Object(U.jsxs)("div",{className:"profileRight",children:[Object(U.jsx)("div",{className:"profileRightTop",children:Object(U.jsxs)("div",{className:"profileCover",children:[Object(U.jsxs)("div",{children:[Object(U.jsx)("img",{className:"profileCoverImg",src:n.coverPicture?n.coverPicture.replace("s3.ap-south-1.amazonaws.com/social-app-assets","d225jocw4xhwve.cloudfront.net"):"https://d225jocw4xhwve.cloudfront.net/pexels-lina-kivaka-2337491.jpg",alt:""}),b.coverPicture&&Object(U.jsx)(Xe.a,{animation:"border",variant:"primary"}),n.username===o.username&&Object(U.jsx)("div",{children:Object(U.jsxs)("label",{htmlFor:"cover",className:"shareOption",children:[Object(U.jsxs)("div",{className:"editCoverImage",children:[Object(U.jsx)(De.a,{}),a>510&&"Edit Cover Photo"]}),Object(U.jsx)("input",{style:{display:"none"},type:"file",id:"cover",accept:".png,.jpeg,.jpg",onChange:function(e){return I(e.target.files[0],"coverPicture")}})]})})]}),Object(U.jsxs)("div",{className:"profileUserImgContainer",children:[b.profilePicture?Object(U.jsx)(Xe.a,{animation:"border",className:"profileUserImg",variant:"primary"}):Object(U.jsx)("img",{className:"profileUserImg",src:n.profilePicture?n.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),n.username===o.username&&Object(U.jsx)("div",{children:Object(U.jsxs)("label",{htmlFor:"file",className:"shareOption",children:[Object(U.jsx)("div",{className:"editProfileImage",children:Object(U.jsx)(Ye.a,{style:{fontSize:"20px"}})}),Object(U.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return I(e.target.files[0],"profilePicture")}})]})})]})]})}),Object(U.jsx)(ze,{user:n,UpdateUserDetails:k,loadingUserDetails:O,mobileView:!0}),Object(U.jsxs)("div",{className:"profileRightBottom",children:[Object(U.jsx)(Te,{username:C,user:n}),Object(U.jsx)(ze,{user:n,UpdateUserDetails:k,loadingUserDetails:O})]})]})]})]})}n(816);var Ze=function(){var e=Object(W.a)(V.a.mark((function e(){var t,n,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]);case 2:return t=e.sent,e.next=5,window.crypto.subtle.exportKey("jwk",t.publicKey);case 5:return n=e.sent,e.next=8,window.crypto.subtle.exportKey("jwk",t.privateKey);case 8:return c=e.sent,e.abrupt("return",{publicKeyJwk:n,privateKeyJwk:c});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=Object(W.a)(V.a.mark((function e(t,n){var c,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.importKey("jwk",t,{name:"ECDH",namedCurve:"P-256"},!0,[]);case 2:return c=e.sent,e.next=5,window.crypto.subtle.importKey("jwk",n,{name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]);case 5:return r=e.sent,e.next=8,window.crypto.subtle.deriveKey({name:"ECDH",public:c},r,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(){var e=Object(W.a)(V.a.mark((function e(t,n){var c,r,a,s,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(new TextEncoder).encode(t),e.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:(new TextEncoder).encode("Initialization Vector")},n,c);case 3:return r=e.sent,a=new Uint8Array(r),s=String.fromCharCode.apply(null,a),i=btoa(s),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),tt=function(){var e=Object(W.a)(V.a.mark((function e(t,n){var c,r,a,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=atob(t),r=new Uint8Array(Object(o.a)(c).map((function(e){return e.charCodeAt(0)}))),a={name:"AES-GCM",iv:(new TextEncoder).encode("Initialization Vector")},e.next=6,window.crypto.subtle.decrypt(a,n,r);case 6:return s=e.sent,e.abrupt("return",(new TextDecoder).decode(s));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return","error decrypting message: ".concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}();function nt(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(N.g)(),s=Object(c.useContext)(T).dispatch,o=Object(c.useState)(!1),u=Object(i.a)(o,2),d=u[0],j=u[1],b=function(){var c=Object(W.a)(V.a.mark((function c(i){var o,u;return V.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(j(!0),i.preventDefault(),r.current.value===n.current.value){c.next=7;break}y.b.warning("Passwords don't match!"),j(!1),c.next=12;break;case 7:return c.next=9,Ze();case 9:o=c.sent,u=Object(l.a)({username:e.current.value,email:t.current.value,password:n.current.value},o),Z(u,s).then((function(e){y.b.success("Registration done successfully. Please login to continue."),j(!1),a.push("/login")})).catch((function(e){var t;console.log(e),j(!1),y.b.error((null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)||"Something went wrong!")}));case 12:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}();return Object(U.jsx)("div",{className:"login",children:Object(U.jsxs)("div",{className:"loginWrapper row align-items-center",children:[Object(U.jsxs)("div",{className:"loginLeft col-md-6",children:[Object(U.jsx)("h3",{className:"loginLogo",children:"ViaChat"}),Object(U.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on ViaChat."})]}),Object(U.jsx)("div",{className:"loginRight col-md-6",children:Object(U.jsxs)("form",{className:"loginBox",onSubmit:b,children:[Object(U.jsx)("input",{placeholder:"Username",required:!0,ref:e,name:"username",className:"loginInput"}),Object(U.jsx)("input",{placeholder:"Email",required:!0,ref:t,name:"email",className:"loginInput",type:"email"}),Object(U.jsx)("input",{placeholder:"Password",required:!0,ref:n,name:"password",className:"loginInput",type:"password",minLength:"6"}),Object(U.jsx)("input",{placeholder:"Confirm Password",required:!0,ref:r,name:"passwordAgain",className:"loginInput",type:"password"}),Object(U.jsx)("button",{className:"loginButton",type:"submit",disabled:d,children:d?Object(U.jsx)(qe.a,{color:"white",size:"20px"}):"Sign Up"}),Object(U.jsx)("button",{className:"loginRegisterButton",onClick:function(){return a.push("/login")},disabled:d,children:d?Object(U.jsx)(qe.a,{color:"white",size:"20px"}):"Log into Account"})]})})]})})}n(817),n(818);var ct=function(e){var t=e.conversation,n=e.currentUser,r=e.setAllConversations,a=e.AllConversations,s=Object(c.useState)(null),o=Object(i.a)(s,2),l=o[0],u=o[1];return Object(c.useEffect)((function(){var e,c=null===(e=t.members)||void 0===e?void 0:e.find((function(e){return e!==n._id}));$(c).then((function(e){u(e.data);var t=a.map((function(t){return t.members.includes(e.data._id)&&(t.member=e.data),t}));r(t)})).catch((function(e){console.log(e)}))}),[n,t]),Object(U.jsxs)("div",{className:"conversation",children:[Object(U.jsx)("img",{className:"conversationImg",src:(null===l||void 0===l?void 0:l.profilePicture)?null===l||void 0===l?void 0:l.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(U.jsx)("span",{className:"conversationName",children:null===l||void 0===l?void 0:l.username})]})},rt=(n(819),function(e){var t=e.message,n=e.own,a=e.Decrypt,s=e.derivedKeys,o=e.friend,l=e.encryptMessages,u=r.a.useState(""),d=Object(i.a)(u,2),j=d[0],b=d[1],h=Object(c.useContext)(T).user;return r.a.useEffect((function(){(function(){var e=Object(W.a)(V.a.mark((function e(){var n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t.text,s);case 2:n=e.sent,b(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,s]),Object(U.jsxs)("div",{className:"message".concat(n?" own":""),children:[Object(U.jsxs)("div",{className:"messageTop",children:[Object(U.jsx)("img",{className:"messageImg",src:n?(null===h||void 0===h?void 0:h.profilePicture)?null===h||void 0===h?void 0:h.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png":(null===o||void 0===o?void 0:o.profilePicture)?null===o||void 0===o?void 0:o.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(U.jsx)("p",{className:"messageText",children:l?t.text:j})]}),Object(U.jsx)("div",{className:"messageBottom",children:Object(ke.a)(t.createdAt)})]})}),at=(n(820),function(e){var t=e.onlineUsers,n=e.currentId,r=e.setCurrentChat,a=e.updateConversations,s=void 0===a?function(){}:a,l=Object(c.useState)([]),u=Object(i.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)([]),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(c.useState)(!0),m=Object(i.a)(O,2),x=m[0],v=m[1];Object(c.useEffect)((function(){v(!0),te(n).then((function(e){j(e.data),v(!1)})).catch((function(e){console.log(e),v(!1)}))}),[n]),Object(c.useEffect)((function(){f(d.filter((function(e){return null===t||void 0===t?void 0:t.includes(e._id)})))}),[t,d]);return Object(U.jsx)("div",{className:"chatOnline",children:x?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})):d.length>0?d.map((function(e,t){return Object(U.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return t=e._id,void le(n,t).then((function(e){e.data.new&&s({senderId:n,receiverId:t,conversation:e.data.data}),r(e.data.data)})).catch((function(e){console.log(e)}));var t},children:[Object(U.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(U.jsx)("img",{className:"chatOnlineImg",src:(null===e||void 0===e?void 0:e.profilePicture)?null===e||void 0===e?void 0:e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(U.jsx)("div",{className:"chatOnlineBadge".concat((c=e._id,p.some((function(e){return e._id===c}))?" online":""))})]}),Object(U.jsx)("span",{className:"chatOnlineName",children:e.username})]},t);var c})):Object(U.jsx)("span",{className:"noChatText",children:"You don't have any friends yet."})})}),st=n(277),it=n.n(st),ot=n(278),lt=n.n(ot),ut=function(){var e,t=ve().socket,n=Object(c.useState)([]),r=Object(i.a)(n,2),a=r[0],s=r[1],l=Object(c.useState)([]),u=Object(i.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(null),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(c.useState)([]),m=Object(i.a)(O,2),x=m[0],g=m[1],w=Object(c.useState)(null),C=Object(i.a)(w,2),S=C[0],_=C[1],E=Object(c.useState)(""),P=Object(i.a)(E,2),A=P[0],F=P[1],R=Object(c.useState)(),D=Object(i.a)(R,2),B=D[0],M=D[1],K=Object(c.useState)(!1),H=Object(i.a)(K,2),z=H[0],G=H[1],q=Object(c.useState)(!1),J=Object(i.a)(q,2),Y=J[0],X=J[1],Q=Object(c.useState)(!1),Z=Object(i.a)(Q,2),ee=Z[0],te=Z[1],ne=Object(c.useContext)(T).user,ce=be(),re=Object(c.useContext)(fe),ae=re.onlineUsers,ue=re.arrivalMessage,de=re.newConversation,je=Object(c.useRef)(),he=null===(e=Object(N.h)().search)||void 0===e?void 0:e.split("=")[1];Object(c.useEffect)((function(){ue&&(null===p||void 0===p?void 0:p.members.includes(ue.sender))&&g((function(e){return[].concat(Object(o.a)(e),[ue])}))}),[ue,p]),Object(c.useEffect)((function(){if(de){var e=de.conversation;j((function(t){return[].concat(Object(o.a)(t),[e])})),s((function(t){return[].concat(Object(o.a)(t),[e])}))}}),[de]),Object(c.useEffect)((function(){G(!0),se(ne._id).then((function(e){s(e.data),j(e.data),G(!1)})).catch((function(e){console.log(e),G(!1),y.b.error("Something went wrong!")}))}),[ne._id]),Object(c.useEffect)((function(){var e;(X(!0),p)&&$(null===p||void 0===p||null===(e=p.members)||void 0===e?void 0:e.find((function(e){return e!==ne._id}))).then((function(e){_(e.data)})).catch((function(e){return console.log(e)}));ie(null===p||void 0===p?void 0:p._id).then((function(e){g(e.data),X(!1)})).catch((function(e){console.log(e),X(!1),y.b.error("Something went wrong!")}))}),[p,ne]),Object(c.useEffect)((function(){$e(null===S||void 0===S?void 0:S.publicKeyJwk,null===ne||void 0===ne?void 0:ne.privateKeyJwk).then((function(e){M(e)}))}),[S,ne]);var pe=function(){var e=Object(W.a)(V.a.mark((function e(n){var c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,et(A,B);case 3:c=e.sent,A&&oe({conversationId:p._id,sender:ne._id,text:c}).then((function(e){var n;F(""),g([].concat(Object(o.a)(x),[e.data]));var r=null===(n=p.members)||void 0===n?void 0:n.find((function(e){return e!==ne._id}));t.current.emit("sendMessage",{senderId:ne._id,receiverId:r,text:c})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;null===(e=je.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[x]);var Oe=function(e){t.current.emit("addConversation",e)};return Object(c.useEffect)((function(){he&&le(ne._id,he).then((function(e){e.data.new&&Oe({senderId:ne._id,receiverId:he,conversation:e.data.data}),f(e.data.data)})).catch((function(e){console.log(e)}))}),[he,ne]),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(ge,{}),Object(U.jsxs)("div",{className:"messenger ".concat(ce<783?"messengerMobile":""),children:[Object(U.jsx)("div",{className:"chatMenu ".concat(ce<783&&!p?"chatMenuMobile":""),children:Object(U.jsxs)("div",{className:"chatMenuWrapper",children:[Object(U.jsx)("h5",{className:"sectionTitle",children:"Your recent conversations"}),Object(U.jsx)("input",{type:"text",placeholder:"Search for friends",className:"chatMenuInput",onChange:function(e){G(!0);var t=e.target.value;if(""===t)j(a);else{var n=a.filter((function(e){var n;return(null===e||void 0===e||null===(n=e.member)||void 0===n?void 0:n.username.toLocaleLowerCase().includes(t.toLocaleLowerCase()))?e:0}));j(n)}G(!1)}}),z?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2",children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})):d.length>0?d.map((function(e,t){return Object(U.jsx)("div",{onClick:function(){return f(e)},children:Object(U.jsx)(ct,{AllConversations:a,setAllConversations:s,conversation:e,currentUser:ne})},t)})):Object(U.jsx)("span",{className:"noChatText",children:"You don't have any conversations yet."})]})}),Object(U.jsx)("div",{className:"chatBox ".concat(ce<783&&p?"chatBoxMobile":""),children:Object(U.jsxs)("div",{className:"chatBoxWrapper",children:[p&&Object(U.jsxs)("div",{className:"chatBoxHeader d-flex justify-content-between align-items-center",children:[Object(U.jsx)(v.a,{onClick:function(){return f(null)},children:Object(U.jsx)(it.a,{style:{color:"#5e5e5e",fontSize:28}})}),Object(U.jsx)(k.a,{overlayStyle:{whiteSpace:"pre-line",fontSize:13},title:"Enable this if you want to see the encrypt message",placement:"bottom",children:Object(U.jsx)(I.a,{onChange:function(e){return te(e)}})})]}),p?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"chatBoxTop",children:[Y&&Object(o.a)(Array(6).keys()).map((function(e,t){return Object(U.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2 w-50 ".concat(t%2===0?"ms-auto":""),children:[Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{circle:!0,width:40,height:40})}),Object(U.jsx)("div",{className:"w-100 ps-3",children:Object(U.jsx)(L.a,{count:3})})]},t)})),x.length>0?x.map((function(e,t){return Object(U.jsx)("div",{ref:je,children:Object(U.jsx)(rt,{encryptMessages:ee,derivedKeys:B,Decrypt:tt,message:e,friend:S,own:e.sender===ne._id})},t)})):Object(U.jsx)("span",{className:"noConversationText",children:!Y&&"Write your first message to ".concat(null===S||void 0===S?void 0:S.username,"...")})]}),Object(U.jsxs)("div",{className:"chatBoxBottom",children:[Object(U.jsx)("textarea",{className:"chatMessageInput",placeholder:"Write something...",onChange:function(e){return F(e.target.value)},value:A,rows:1}),Object(U.jsx)("button",{className:"chatSubmitBtn",onClick:pe,children:Object(U.jsx)(lt.a,{style:{color:"#fff"}})})]})]}):Object(U.jsx)("span",{className:"noConversationText",children:"Open a conversation to start a chat."})]})}),Object(U.jsx)("div",{className:"chatOnline",children:Object(U.jsxs)("div",{className:"chatOnlineWrapper",children:[Object(U.jsx)("h5",{className:"sectionTitle",children:"Your friends"}),Object(U.jsx)(at,{onlineUsers:ae,currentId:ne._id,setCurrentChat:f,updateConversations:Oe})]})})]})]})},dt=(n(821),n(881)),jt=n(279),bt=n.n(jt),ht=function(){var e=Object(N.g)(),t=be();return"/messenger"===e.location.pathname&&t<783?null:Object(U.jsx)(dt.a,{color:"primary","aria-label":"add",className:"message-ctaBtn",onClick:function(){return e.push("/messenger")},children:Object(U.jsx)(bt.a,{})})};var pt=function(){var e=Object(c.useContext)(T).user,t=Object(c.useContext)(fe).dispatch,n=Object(c.useContext)(B).theme,r=ve().socket;return Object(c.useEffect)((function(){"dark"===n?(document.body.classList.add("darkTheme"),document.body.classList.remove("lightTheme")):(document.body.classList.remove("darkTheme"),document.body.classList.add("lightTheme"))}),[n]),Object(c.useEffect)((function(){r&&r.current&&r.current.on("getUsers",(function(n){console.log({users:n}),t(function(e){return{type:"SET_ONLINE_USERS",payload:e}}(null===e||void 0===e?void 0:e.followings.filter((function(e){return n.some((function(t){return t.userId===e}))}))))}))}),[e,t,r]),Object(U.jsxs)(w.a,{children:[Object(U.jsxs)(N.d,{children:[Object(U.jsx)(N.b,{exact:!0,path:"/",children:e?Object(U.jsx)(Ge,{}):Object(U.jsx)(nt,{})}),Object(U.jsx)(N.b,{path:"/login",children:e?Object(U.jsx)(N.a,{to:"/"}):Object(U.jsx)(Je,{})}),Object(U.jsx)(N.b,{path:"/register",children:e?Object(U.jsx)(N.a,{to:"/"}):Object(U.jsx)(nt,{})}),Object(U.jsx)(N.b,{path:"/messenger",children:e?Object(U.jsx)(ut,{}):Object(U.jsx)(N.a,{to:"/"})}),Object(U.jsx)(N.b,{path:"/profile/:username",children:e?Object(U.jsx)(Qe,{}):Object(U.jsx)(N.a,{to:"/"})})]}),e&&Object(U.jsx)(ht,{})]})};n(822),n(823),n(824),n(825);s.a.render(Object(U.jsx)(r.a.StrictMode,{children:Object(U.jsx)(F,{children:Object(U.jsx)(Oe,{children:Object(U.jsx)(M,{children:Object(U.jsx)(pt,{})})})})}),document.getElementById("root"))}},[[826,1,2]]]);
//# sourceMappingURL=main.d0e3b9e7.chunk.js.map