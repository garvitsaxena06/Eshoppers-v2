{"version":3,"sources":["context/Auth/AuthReducer.js","context/Auth/index.js","context/Theme/ThemeReducer.js","context/Theme/index.js","context/Theme/ThemeActions.js","utils/connections.js","apiCalls.js","utils/windowSize.js","context/Socket/SocketReducer.js","context/Socket/index.js","components/online/Online.jsx","context/Socket/SocketActions.js","utils/crypto.js","utils/pushNotification.js","utils/socket.js","components/topbar/Topbar.jsx","components/closeFriend/CloseFriend.jsx","components/sidebar/Sidebar.jsx","components/post/Post.jsx","utils/upload.js","components/share/Share.jsx","components/feed/Feed.jsx","components/modals/userInfo.js","components/rightbar/Rightbar.jsx","pages/home/Home.jsx","pages/login/Login.jsx","pages/profile/Profile.jsx","pages/register/Register.jsx","components/conversation/Conversation.jsx","components/message/Message.jsx","components/chatOnline/ChatOnline.jsx","pages/messenger/Messenger.jsx","components/floatingMessage/Floating.jsx","App.js","index.js"],"names":["AuthReducer","state","action","type","user","isFetching","error","payload","followings","filter","following","INITIAL_STATE","JSON","parse","localStorage","getItem","AuthContext","createContext","AuthContextProvider","children","useReducer","dispatch","useEffect","setItem","stringify","Provider","value","ThemeReducer","theme","ThemeContext","ThemeContextProvider","changeTheme","POSTS_BASE_URL","USERS_BASE_URL","CONVERSATIONS_BASE_URL","MESSAGES_BASE_URL","loginCall","userCredential","a","axios","post","res","data","message","success","response","RegisterCall","getUserById","id","get","getUserByUsername","getFriends","getFriendsByUserName","unfollow","userId","put","follow","updateUser","getConversations","getMessages","sendNewMessage","getConversationByOfTwoUsers","us1","us2","searchUserByUsername","q","likePost","_id","deletePost","delete","useWindowSize","useState","size","setSize","useLayoutEffect","updateSize","window","innerWidth","addEventListener","removeEventListener","SocketReducer","onlineUsers","arrivalMessage","newConversation","SocketContext","SocketProvider","Online","online","className","src","profilePicture","alt","username","setArrivalMessage","GenerateKeys","crypto","subtle","generateKey","name","namedCurve","keyPair","exportKey","publicKey","publicKeyJwk","privateKey","privateKeyJwk","DeriveKeys","importKey","deriveKey","public","length","Encrypt","text","derivedKey","encodedText","TextEncoder","encode","encrypt","iv","encryptedData","uintArray","Uint8Array","string","String","fromCharCode","apply","base64Data","btoa","Decrypt","atob","map","char","charCodeAt","algorithm","decrypt","decryptedData","TextDecoder","decode","PushNotification","useContext","pushNotification","senderId","then","sender","decryptMessage","addNotification","title","subtitle","native","duration","closeButton","silent","catch","err","console","log","useSocket","socket","useRef","current","io","emit","on","createdAt","Date","now","conversation","setNewConversation","Topbar","themeDispatch","history","useHistory","searchedItems","setSearchedItems","visible","setVisible","friends","setFriends","arrivalMessageContent","setArrivalMessageContent","onlineFriends","setOnlineFriends","loadingFriends","setLoadingFriends","width","el","includes","closeHandler","logoutHandler","removeItem","push","menu","Item","to","onClick","messagesDropdown","style","cursor","description","textDecoration","Search","Autocomplete","freeSolo","options","PaperComponent","Paper","background","border","getOptionLabel","option","renderOption","email","renderInput","params","TextField","label","margin","onChange","e","target","handleSearch","InputProps","overlay","trigger","Chat","overlayStyle","whiteSpace","fontSize","placement","checked","IconButton","color","onClose","height","Home","Timeline","ExitToApp","Array","keys","i","circle","count","u","some","CloseFriend","replace","Sidebar","RssFeed","Post","fetchPosts","differentUser","index","likes","like","setLike","isLiked","setIsLiked","setUser","currentUser","fetchUser","deleteHandler","format","MoreVert","desc","img","process","AWS","require","config","secretAccessKey","accessKeyId","region","s3bucket","S3","bucketName","upload","file","cb","fileName","getTime","Bucket","Key","Expires","ContentType","ACL","getSignedUrl","headers","url","CLOUDFRONT_ASSETS_URL","Share","imageRef","setFile","uploadPost","submitHandler","preventDefault","warning","placeholder","ref","URL","createObjectURL","Cancel","onSubmit","htmlFor","PermMedia","htmlColor","display","accept","files","Feed","userProps","posts","setPosts","loadingPosts","setLoadingPosts","sort","p1","p2","p","UserInfo","show","handleClose","handleSubmit","validated","setValidated","firstName","lastName","city","setState","prev","Modal","onHide","Header","Title","Body","Form","noValidate","event","form","currentTarget","checkValidity","stopPropagation","Group","as","Col","controlId","Label","Control","required","minLength","Feedback","Button","variant","marginLeft","Rightbar","UpdateUserDetails","loadingUserDetails","mobileView","followed","setFollowed","friendList","getUserFriends","handleClick","HomeRightbar","ProfileRightbar","setShow","Remove","Add","Edit","friend","Login","password","disabled","CircularProgress","Profile","loggedInUser","coverPicture","loading","setLoading","setLoadingUserDetails","useParams","handleFileUpload","Spinner","animation","CameraAlt","Register","passwordAgain","Conversation","setAllConversations","AllConversations","friendId","members","find","newConversations","member","Message","own","derivedKeys","encryptMessages","setSendFile","setIsVisible","React","decryptedMessage","startsWith","ChatOnline","currentId","setCurrentChat","updateConversations","new","receiverId","Messenger","conversations","setConversations","currentChat","messages","setMessages","setFriend","newMessage","setNewMessage","decryptionKeys","setDecryptionKeys","loadingConversations","setLoadingConversations","loadingMessages","setLoadingMessages","setEncryptMessages","sendFile","sendingFile","setSendingFile","isVisible","scrollRef","useLocation","search","split","b","sendMessageHandler","encryptedMessages","conversationId","scrollIntoView","behavior","closeModal","filteredConversations","con","toLocaleLowerCase","rows","originFileObj","beforeUpload","onCancel","footer","Floating","location","pathname","Fab","aria-label","App","document","body","classList","add","remove","users","setOnlineUsers","exact","path","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c382cb47.chunk.js","sourcesContent":["const AuthReducer = (state, action) => {\n  switch (action.type) {\n    case 'LOGIN_START':\n      return {\n        user: null,\n        isFetching: true,\n        error: false,\n      }\n    case 'LOGIN_SUCCESS':\n      return {\n        user: action.payload,\n        isFetching: false,\n        error: false,\n      }\n    case 'LOGIN_FAILURE':\n      return {\n        user: null,\n        isFetching: false,\n        error: true,\n      }\n    case 'FOLLOW':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          followings: [...state.user.followings, action.payload],\n        },\n      }\n    case 'UNFOLLOW':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          followings: state.user.followings.filter(\n            (following) => following !== action.payload\n          ),\n        },\n      }\n    case 'UPDATE':\n      return {\n        ...state,\n        user: action.payload,\n      }\n    case 'LOGOUT':\n      return {\n        user: null,\n        isFetching: false,\n        error: false,\n      }\n    default:\n      return state\n  }\n}\n\nexport default AuthReducer\n","import { createContext, useEffect, useReducer } from 'react'\nimport AuthReducer from './AuthReducer'\n\nconst INITIAL_STATE = {\n  user: JSON.parse(localStorage.getItem('user')) || null,\n  isFetching: false,\n  error: false,\n}\n\nexport const AuthContext = createContext(INITIAL_STATE)\n\nexport const AuthContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(AuthReducer, INITIAL_STATE)\n\n  useEffect(() => {\n    localStorage.setItem('user', JSON.stringify(state.user))\n  }, [state.user])\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user: state.user,\n        isFetching: state.isFetching,\n        error: state.error,\n        dispatch,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n","const ThemeReducer = (state, action) => {\n  switch (action.type) {\n    case 'CHANGE_THEME':\n      return {\n        theme: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nexport default ThemeReducer\n","import { createContext, useReducer } from 'react'\nimport ThemeReducer from './ThemeReducer'\n\nconst INITIAL_STATE = {\n  theme: localStorage.getItem('theme') || 'light',\n}\n\nexport const ThemeContext = createContext(INITIAL_STATE)\n\nexport const ThemeContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(ThemeReducer, INITIAL_STATE)\n\n  return (\n    <ThemeContext.Provider\n      value={{\n        theme: state.theme,\n        dispatch,\n      }}\n    >\n      {children}\n    </ThemeContext.Provider>\n  )\n}\n","export const changeTheme = (theme) => ({\n  type: 'CHANGE_THEME',\n  payload: theme,\n})\n","export const POSTS_BASE_URL = \"https://k5gxjlwjl0.execute-api.ap-south-1.amazonaws.com/posts\";\n\nexport const USERS_BASE_URL = \"https://2r0sg4bxg5.execute-api.ap-south-1.amazonaws.com/users\";\n\nexport const CONVERSATIONS_BASE_URL = \"https://95rv9rmrxi.execute-api.ap-south-1.amazonaws.com/conversations\";\n\nexport const MESSAGES_BASE_URL = \"https://5kq2t3b9fi.execute-api.ap-south-1.amazonaws.com/messages\";\n","import axios from 'axios'\nimport { message } from 'antd'\nimport {\n  POSTS_BASE_URL,\n  USERS_BASE_URL,\n  MESSAGES_BASE_URL,\n  CONVERSATIONS_BASE_URL,\n} from './utils/connections.js'\n\nexport const loginCall = async (userCredential, dispatch) => {\n  dispatch({ type: 'LOGIN_START' })\n  try {\n    const res = await axios.post(`${USERS_BASE_URL}/login`, userCredential)\n    dispatch({ type: 'LOGIN_SUCCESS', payload: res.data })\n    message.success('Logged in successfully.')\n  } catch (err) {\n    dispatch({ type: 'LOGIN_FAILURE', payload: err })\n    message.error(err?.response?.data?.message)\n  }\n}\n\nexport const RegisterCall = async (user, dispatch) =>\n  await axios.post(`${USERS_BASE_URL}/register`, user)\n\nexport const getUserById = async (id) =>\n  await axios.get(`${USERS_BASE_URL}?userId=` + id)\n\nexport const getUserByUsername = async (id) =>\n  await axios.get(`${USERS_BASE_URL}?username=` + id)\n\nexport const getFriends = async (id) =>\n  await axios.get(`${USERS_BASE_URL}/friends/` + id)\n\nexport const getFriendsByUserName = async (id) =>\n  await axios.get(`${USERS_BASE_URL}/friendsByUserName/` + id)\n\nexport const unfollow = async (id, userId) =>\n  await axios.put(`${USERS_BASE_URL}/${id}/unfollow`, {\n    userId,\n  })\n\nexport const follow = async (id, userId) =>\n  await axios.put(`${USERS_BASE_URL}/${id}/follow`, {\n    userId,\n  })\n\nexport const updateUser = async (data) => {\n  return await axios.put(`${USERS_BASE_URL}/${data.userId}`, data)\n}\n\nexport const getConversations = async (id) => {\n  return await axios.get(`${CONVERSATIONS_BASE_URL}/` + id)\n}\n\nexport const getMessages = async (id) => {\n  return await axios.get(`${MESSAGES_BASE_URL}/` + id)\n}\n\nexport const sendNewMessage = async (payload) => {\n  return await axios.post(`${MESSAGES_BASE_URL}`, payload)\n}\n\nexport const getConversationByOfTwoUsers = async (us1, us2) => {\n  return await axios.get(`${CONVERSATIONS_BASE_URL}/find/${us1}/${us2}`)\n}\n\nexport const searchUserByUsername = async (q) => {\n  return await axios.get(`${USERS_BASE_URL}/search?q=${q}`)\n}\n\nexport const likePost = async ({ _id, payload }) =>\n  await axios.put(`${POSTS_BASE_URL}/${_id}/like`, payload)\n\nexport const deletePost = async ({ _id, userId }) =>\n  await axios.delete(`${POSTS_BASE_URL}/${_id}`)\n","import { useLayoutEffect, useState } from 'react'\n\nconst useWindowSize = () => {\n  const [size, setSize] = useState(0)\n\n  useLayoutEffect(() => {\n    const updateSize = () => {\n      setSize(window.innerWidth)\n    }\n    window.addEventListener('resize', updateSize)\n    updateSize()\n    return () => {\n      window.removeEventListener('resize', updateSize)\n    }\n  }, [])\n  return size\n}\n\nexport default useWindowSize\n","const SocketReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_ONLINE_USERS':\n      return {\n        ...state,\n        onlineUsers: action.payload,\n      }\n    case 'SET_ARRIVAL_MESSAGE':\n      return {\n        ...state,\n        arrivalMessage: action.payload,\n      }\n    case 'SET_NEW_CONVERSATION':\n      return {\n        ...state,\n        newConversation: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nexport default SocketReducer\n","import { createContext, useReducer } from 'react'\nimport SocketReducer from './SocketReducer'\n\nconst INITIAL_STATE = {\n  onlineUsers: [],\n  arrivalMessage: null,\n  newConversation: null,\n}\n\nexport const SocketContext = createContext(INITIAL_STATE)\n\nexport const SocketProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(SocketReducer, INITIAL_STATE)\n\n  return (\n    <SocketContext.Provider\n      value={{\n        onlineUsers: state.onlineUsers,\n        arrivalMessage: state.arrivalMessage,\n        newConversation: state.newConversation,\n        dispatch,\n      }}\n    >\n      {children}\n    </SocketContext.Provider>\n  )\n}\n","import './online.css'\n\nexport default function Online({ user, online = true }) {\n  return (\n    <li className='rightbarFriend'>\n      <div className='rightbarProfileImgContainer'>\n        <img\n          className='rightbarProfileImg'\n          src={\n            user.profilePicture !== ''\n              ? user.profilePicture\n              : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n          }\n          alt=''\n        />\n        <span className={online ? 'rightbarOnline' : 'rightbarOffline'}></span>\n      </div>\n      <span className='rightbarUsername'>{user.username}</span>\n    </li>\n  )\n}\n","export const setOnlineUsers = (users) => ({\n  type: 'SET_ONLINE_USERS',\n  payload: users,\n})\n\nexport const setArrivalMessage = (message) => ({\n  type: 'SET_ARRIVAL_MESSAGE',\n  payload: message,\n})\n\nexport const setNewConversation = (conversation) => ({\n  type: 'SET_NEW_CONVERSATION',\n  payload: conversation,\n})\n","export const GenerateKeys = async () => {\n  const keyPair = await window.crypto.subtle.generateKey(\n    {\n      name: 'ECDH',\n      namedCurve: 'P-256',\n    },\n    true,\n    ['deriveKey', 'deriveBits'],\n  )\n\n  const publicKeyJwk = await window.crypto.subtle.exportKey(\n    'jwk',\n    keyPair.publicKey,\n  )\n\n  const privateKeyJwk = await window.crypto.subtle.exportKey(\n    'jwk',\n    keyPair.privateKey,\n  )\n\n  return { publicKeyJwk, privateKeyJwk }\n}\n\nexport const DeriveKeys = async (publicKeyJwk, privateKeyJwk) => {\n  const publicKey = await window.crypto.subtle.importKey(\n    'jwk',\n    publicKeyJwk,\n    {\n      name: 'ECDH',\n      namedCurve: 'P-256',\n    },\n    true,\n    [],\n  )\n\n  const privateKey = await window.crypto.subtle.importKey(\n    'jwk',\n    privateKeyJwk,\n    {\n      name: 'ECDH',\n      namedCurve: 'P-256',\n    },\n    true,\n    ['deriveKey', 'deriveBits'],\n  )\n\n  return await window.crypto.subtle.deriveKey(\n    { name: 'ECDH', public: publicKey },\n    privateKey,\n    { name: 'AES-GCM', length: 256 },\n    true,\n    ['encrypt', 'decrypt'],\n  )\n}\n\nexport const Encrypt = async (text, derivedKey) => {\n  const encodedText = new TextEncoder().encode(text)\n\n  const encryptedData = await window.crypto.subtle.encrypt(\n    { name: 'AES-GCM', iv: new TextEncoder().encode('Initialization Vector') },\n    derivedKey,\n    encodedText,\n  )\n\n  const uintArray = new Uint8Array(encryptedData)\n\n  const string = String.fromCharCode.apply(null, uintArray)\n\n  const base64Data = btoa(string)\n  \n  return base64Data\n}\n\nexport const Decrypt = async (text, derivedKey) => {\n  try {\n    const string = atob(text)\n    const uintArray = new Uint8Array(\n      [...string].map((char) => char.charCodeAt(0)),\n    )\n    const algorithm = {\n      name: 'AES-GCM',\n      iv: new TextEncoder().encode('Initialization Vector'),\n    }\n    const decryptedData = await window.crypto.subtle.decrypt(\n      algorithm,\n      derivedKey,\n      uintArray,\n    )\n\n    return new TextDecoder().decode(decryptedData)\n  } catch (e) {\n    return `error decrypting message: ${e}`\n  }\n}\n","import { useContext } from 'react'\nimport addNotification from 'react-push-notification'\nimport { getUserById } from '../apiCalls'\nimport { AuthContext } from '../context/Auth'\nimport { Decrypt, DeriveKeys } from './crypto'\n\nconst PushNotification = () => {\n  const { user } = useContext(AuthContext)\n  const pushNotification = ({ senderId, text }) => {\n    getUserById(senderId)\n      .then((sender) => {\n        DeriveKeys(sender.data?.publicKeyJwk, user?.privateKeyJwk)\n          .then((res) => {\n            Decrypt(text, res)\n              .then((decryptMessage) => {\n                addNotification({\n                  title: `New message from ${sender.data?.username}`,\n                  subtitle: `${sender.data?.username} says`,\n                  message: decryptMessage,\n                  native: false,\n                  duration: 10000,\n                  closeButton: 'Close',\n                  silent: false,\n                })\n                addNotification({\n                  title: `New message from ${sender.data?.username}`,\n                  subtitle: `${sender.data?.username} says`,\n                  message: decryptMessage,\n                  native: true,\n                  duration: 10000,\n                  closeButton: 'Close',\n                  silent: false,\n                })\n              })\n              .catch((err) => console.log(err))\n          })\n          .catch((err) => console.log(err))\n      })\n      .catch((err) => console.log(err))\n  }\n\n  return { pushNotification }\n}\n\nexport default PushNotification\n","import { useRef, useEffect, useContext } from 'react'\nimport { io } from 'socket.io-client'\nimport { AuthContext } from '../context/Auth'\nimport { SocketContext } from '../context/Socket'\nimport {\n  setArrivalMessage,\n  setNewConversation,\n} from '../context/Socket/SocketActions'\nimport PushNotification from './pushNotification'\n\nconst useSocket = () => {\n  const { user } = useContext(AuthContext)\n  const { dispatch } = useContext(SocketContext)\n  const socket = useRef()\n  const { pushNotification } = PushNotification()\n\n  useEffect(() => {\n    if (user) {\n      socket.current = io('https://socket.docplus.online/chat')\n      socket.current.emit('addUser', user?._id)\n      socket.current.on('getMessage', ({ senderId, text }) => {\n        dispatch(\n          setArrivalMessage({\n            sender: senderId,\n            text,\n            createdAt: Date.now(),\n          })\n        )\n        pushNotification({ senderId, text })\n      })\n      socket.current.on('getConversation', ({ senderId, conversation }) => {\n        dispatch(setNewConversation({ senderId, conversation }))\n      })\n    }\n    // eslint-disable-next-line\n  }, [user, dispatch])\n\n  return { socket }\n}\n\nexport default useSocket\n","import './topbar.css'\nimport {\n  Search,\n  //Person,\n  Chat,\n  Home,\n  Timeline,\n  Message,\n  ExitToApp,\n} from '@material-ui/icons'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport Autocomplete from '@material-ui/lab/Autocomplete'\nimport TextField from '@material-ui/core/TextField'\nimport IconButton from '@material-ui/core/IconButton'\nimport Paper from '@material-ui/core/Paper'\nimport { Link, useHistory } from 'react-router-dom'\nimport {\n  Menu,\n  Dropdown,\n  message,\n  Drawer,\n  Divider,\n  Switch,\n  Tooltip,\n  Empty,\n} from 'antd'\nimport React, { useContext, useState, useEffect } from 'react'\nimport Skeleton from 'react-loading-skeleton'\nimport { AuthContext } from '../../context/Auth'\nimport { ThemeContext } from '../../context/Theme'\nimport { changeTheme } from '../../context/Theme/ThemeActions'\nimport { getFriends, getUserById, searchUserByUsername } from '../../apiCalls'\nimport useWindowSize from '../../utils/windowSize'\nimport { SocketContext } from '../../context/Socket'\nimport Online from '../online/Online'\nimport useSocket from '../../utils/socket'\nimport { Decrypt, DeriveKeys } from '../../utils/crypto'\n\nexport default function Topbar() {\n  const { user, dispatch } = useContext(AuthContext)\n  const { onlineUsers, arrivalMessage } = useContext(SocketContext)\n  const { socket } = useSocket()\n  const { theme, dispatch: themeDispatch } = useContext(ThemeContext)\n  const history = useHistory()\n  const [searchedItems, setSearchedItems] = useState([])\n  const [visible, setVisible] = useState(false)\n  const [friends, setFriends] = useState([])\n  const [arrivalMessageContent, setArrivalMessageContent] = useState(null)\n  const [onlineFriends, setOnlineFriends] = useState([])\n  const [loadingFriends, setLoadingFriends] = useState(true)\n  const width = useWindowSize()\n\n  useEffect(() => {\n    setLoadingFriends(true)\n    getFriends(user._id)\n      .then((res) => {\n        setFriends(res.data)\n        setLoadingFriends(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingFriends(false)\n      })\n  }, [user._id])\n\n  useEffect(() => {\n    setOnlineFriends(friends.filter((el) => onlineUsers?.includes(el._id)))\n  }, [onlineUsers, friends])\n\n  const handleSearch = (e) => {\n    const { value } = e.target\n    if (value) {\n      searchUserByUsername(value)\n        .then((res) => {\n          setSearchedItems(res.data)\n        })\n        .catch((err) => {\n          console.log(err)\n          setSearchedItems([])\n        })\n    } else {\n      setSearchedItems([])\n    }\n  }\n\n  const showHandler = () => {\n    setVisible(true)\n  }\n\n  const closeHandler = () => {\n    setVisible(false)\n  }\n\n  const logoutHandler = () => {\n    localStorage.removeItem('user')\n    dispatch({ type: 'LOGOUT' })\n    socket.current.emit('logoutUser', user._id)\n    message.success('Logout successfully.')\n    history.push('/')\n  }\n\n  useEffect(() => {\n    if (arrivalMessage) {\n      getUserById(arrivalMessage?.sender)\n        .then((sender) => {\n          DeriveKeys(sender.data?.publicKeyJwk, user?.privateKeyJwk)\n            .then((res) => {\n              Decrypt(arrivalMessage?.text, res)\n                .then((decryptMessage) => {\n                  setArrivalMessageContent({\n                    username: sender.data?.username,\n                    message: decryptMessage,\n                    profilePicture: sender.data?.profilePicture,\n                    userId: sender.data?._id,\n                  })\n                })\n                .catch((err) => console.log(err))\n            })\n            .catch((err) => console.log(err))\n        })\n        .catch((err) => console.log(err))\n    }\n  }, [arrivalMessage, user])\n\n  const menu = (\n    <Menu>\n      <Menu.Item key='Profile'>\n        <Link to={`/profile/${user.username}`}>Profile</Link>\n      </Menu.Item>\n      <Menu.Item key='Logout'>\n        <div onClick={logoutHandler}>Logout</div>\n      </Menu.Item>\n    </Menu>\n  )\n\n  const messagesDropdown = (\n    <div className='searchSuggestions messageNotifBox'>\n      {arrivalMessage ? (\n        <>\n          <div className='profilePicture'>\n            <img\n              src={\n                arrivalMessageContent?.profilePicture\n                  ? arrivalMessageContent?.profilePicture\n                  : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n              }\n              alt=''\n              className='topbarImg'\n            />\n          </div>\n          <div\n            className='searchContent'\n            style={{ cursor: 'pointer' }}\n            onClick={() =>\n              history.push(`/messenger?q=${arrivalMessageContent?.userId}`)\n            }\n          >\n            <div className='email'>{arrivalMessageContent?.username}</div>\n            <div className='username'>{arrivalMessageContent?.message}</div>\n          </div>\n        </>\n      ) : (\n        <Empty description='No new messages' />\n      )}\n    </div>\n  )\n\n  const checkUserOnline = (id) => {\n    return onlineFriends.some((el) => el._id === id)\n  }\n\n  return (\n    <div className='topbarContainer'>\n      <div className='topbarLeft'>\n        <Link to='/' style={{ textDecoration: 'none' }}>\n          <span className='logo'>ViaChat</span>\n        </Link>\n      </div>\n      <div className='topbarCenter'>\n        <div className='searchbar'>\n          <Search className='searchIcon' />\n          <Autocomplete\n            freeSolo\n            id='free-solo-2-demo'\n            options={searchedItems}\n            PaperComponent={({ children }) => (\n              <Paper\n                style={\n                  theme === 'dark'\n                    ? {\n                        background: '#0a0c0e',\n                        border: '1px solid #181111',\n                      }\n                    : {}\n                }\n              >\n                {children}\n              </Paper>\n            )}\n            getOptionLabel={(option) => option.username}\n            renderOption={(option) => (\n              <div\n                className='searchSuggestions'\n                onClick={() => history.push(`/profile/${option.username}`)}\n              >\n                <div className='profilePicture'>\n                  <img\n                    src={\n                      option.profilePicture\n                        ? option.profilePicture\n                        : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n                    }\n                    alt=''\n                    className='topbarImg'\n                  />\n                </div>\n                <div className='searchContent'>\n                  <div className='email'>{option.email}</div>\n                  <div className='username'>{option.username}</div>\n                </div>\n              </div>\n            )}\n            renderInput={(params) => (\n              <TextField\n                {...params}\n                label={\n                  width > 340\n                    ? `Search for friend (by username)`\n                    : `Search for friend`\n                }\n                margin='normal'\n                onChange={(e) => handleSearch(e)}\n                InputProps={{ ...params.InputProps, type: 'search' }}\n              />\n            )}\n          />\n        </div>\n      </div>\n      <div className='topbarRight'>\n        <div className='topbarLinks'>\n          <span className='topbarLink' onClick={() => history.push('/')}>\n            Homepage\n          </span>\n          <span\n            className='topbarLink'\n            onClick={() => history.push(`/profile/${user.username}`)}\n          >\n            Timeline\n          </span>\n        </div>\n\n        <div className='d-flex align-items-center'>\n          <div className='topbarIcons'>\n            {/* <div className=\"topbarIconItem\">\n              <Person />\n              <span className=\"topbarIconBadge\">1</span>\n            </div> */}\n            <Dropdown overlay={messagesDropdown} trigger={['click']}>\n              <div className='topbarIconItem'>\n                <Chat />\n\n                <span className='topbarIconBadge'>\n                  {arrivalMessage ? 1 : 0}\n                </span>\n              </div>\n            </Dropdown>\n            <div className='topbarIconItem'>\n              <Tooltip\n                overlayStyle={{ whiteSpace: 'pre-line', fontSize: 13 }}\n                title={`Dark theme`}\n                placement='bottom'\n              >\n                <Switch\n                  size='small'\n                  checked={theme === 'dark' ? true : false}\n                  onChange={(checked) => {\n                    themeDispatch(changeTheme(checked ? 'dark' : 'light'))\n                    localStorage.setItem('theme', checked ? 'dark' : 'light')\n                  }}\n                />\n              </Tooltip>\n\n              {/* <span className=\"topbarIconBadge\">1</span> */}\n            </div>\n          </div>\n          <span className='helloUserText'>Hello, {user?.username}</span>\n          <Dropdown overlay={menu}>\n            <img\n              src={\n                user.profilePicture\n                  ? user.profilePicture\n                  : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n              }\n              alt=''\n              className='topbarImg'\n            />\n          </Dropdown>\n        </div>\n      </div>\n      <div className='menuIcon'>\n        <IconButton onClick={showHandler}>\n          <MenuIcon style={{ color: '#fff' }} />\n        </IconButton>\n      </div>\n      <Drawer\n        width={width > 370 ? 320 : '100%'}\n        placement='right'\n        visible={visible}\n        onClose={closeHandler}\n      >\n        <div className='profileContainer'>\n          <img\n            src={\n              user.profilePicture\n                ? user.profilePicture\n                : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n            }\n            style={{ width: 80, height: 80 }}\n            alt=''\n            className='topbarImg'\n          />\n          <div className='profileContent ms-2'>\n            <h5 className='profileUsername'>\n              Hello, <br /> <strong>@{user.username}</strong>\n            </h5>\n            <Link to={`/profile/${user.username}`}>Visit your profile</Link>\n          </div>\n        </div>\n        <Divider />\n        <div className='profileLinks'>\n          <div className='profileLink'>\n            <Home />\n            <span onClick={() => history.push(`/`)}>Homepage</span>\n          </div>\n          <div className='profileLink'>\n            <Timeline />\n            <span onClick={() => history.push(`/profile/${user.username}`)}>\n              Timeline\n            </span>\n          </div>\n          <div className='profileLink'>\n            <Message />\n            <span onClick={() => history.push(`/messenger`)}>Messenger</span>\n          </div>\n          <div className='profileLink'>\n            <ExitToApp />\n            <span onClick={logoutHandler}>Logout</span>\n          </div>\n          <Divider />\n          <div className='profileLink mt-2'>\n            <Switch\n              checked={theme === 'dark' ? true : false}\n              onChange={(checked) => {\n                themeDispatch(changeTheme(checked ? 'dark' : 'light'))\n                localStorage.setItem('theme', checked ? 'dark' : 'light')\n              }}\n            />\n            Toggle theme\n          </div>\n        </div>\n        <Divider />\n        <h5 className='profileUsername mb-3'>Your friends</h5>\n        {!loadingFriends\n          ? friends.map((u) => {\n              const online = checkUserOnline(u._id)\n              return (\n                <div\n                  key={u._id}\n                  onClick={() => {\n                    closeHandler()\n                    history.push(`/messenger?q=${u._id}`)\n                  }}\n                  style={{ cursor: 'pointer' }}\n                >\n                  <Online key={u._id} user={u} online={online} />\n                </div>\n              )\n            })\n          : [...Array(2).keys()].map((el, i) => (\n              <div key={i} className='d-flex align-items-center pe-3 py-2'>\n                <div>\n                  <Skeleton circle width={40} height={40} />\n                </div>\n                <div className='w-100 ps-3'>\n                  <Skeleton count={3} />\n                </div>\n              </div>\n            ))}\n      </Drawer>\n    </div>\n  )\n}\n","import './closeFriend.css'\nimport { useHistory } from 'react-router'\n\nexport default function CloseFriend({ user }) {\n  const history = useHistory()\n  return (\n    <li\n      className='sidebarFriend'\n      onClick={() => history.push('/profile/' + user.username)}\n    >\n      <img\n        className='sidebarFriendImg'\n        src={\n          user.profilePicture !== ''\n            ? user.profilePicture.replace(\n                's3.ap-south-1.amazonaws.com/social-app-assets',\n                'd225jocw4xhwve.cloudfront.net'\n              )\n            : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n        }\n        alt=''\n      />\n      <span className='sidebarFriendName'>{user.username}</span>\n    </li>\n  )\n}\n","import { useContext, useEffect, useState } from 'react'\nimport './sidebar.css'\nimport {\n  RssFeed,\n  Chat,\n  // PlayCircleFilledOutlined,\n  // Group,\n  // Bookmark,\n  // HelpOutline,\n  // WorkOutline,\n  // Event,\n  // School,\n} from '@material-ui/icons'\nimport Skeleton from 'react-loading-skeleton'\n// import { Users } from '../../dummyData'\nimport CloseFriend from '../closeFriend/CloseFriend'\nimport { useHistory } from 'react-router-dom'\nimport { AuthContext } from '../../context/Auth'\nimport { getFriends } from '../../apiCalls'\n\nexport default function Sidebar() {\n  const { user } = useContext(AuthContext)\n  const history = useHistory()\n\n  const [friends, setFriends] = useState([])\n  const [loadingFriends, setLoadingFriends] = useState(true)\n\n  useEffect(() => {\n    setLoadingFriends(true)\n    getFriends(user._id)\n      .then((res) => {\n        setFriends(res.data)\n        setLoadingFriends(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingFriends(false)\n      })\n  }, [user])\n\n  return (\n    <div className='sidebar'>\n      <div className='sidebarWrapper'>\n        <ul className='sidebarList'>\n          <li\n            className='sidebarListItem'\n            onClick={() => history.push(`/profile/${user.username}`)}\n          >\n            <RssFeed className='sidebarIcon' />\n            <span className='sidebarListItemText'>Feed</span>\n          </li>\n          <li\n            className='sidebarListItem'\n            onClick={() => history.push('/messenger')}\n          >\n            <Chat className='sidebarIcon' />\n            <span className='sidebarListItemText'>Chats</span>\n          </li>\n          {/* <li className=\"sidebarListItem\">\n            <PlayCircleFilledOutlined className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Videos</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Group className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Groups</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Bookmark className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Bookmarks</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <HelpOutline className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Questions</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <WorkOutline className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Jobs</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Event className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Events</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <School className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Courses</span>\n          </li> */}\n        </ul>\n        {/* <button className=\"sidebarButton\">Show More</button> */}\n        <hr className='sidebarHr' />\n        <ul className='sidebarFriendList'>\n          {!loadingFriends\n            ? friends.map((u) => <CloseFriend key={u._id} user={u} />)\n            : [...Array(3).keys()].map((el, i) => (\n                <div key={i} className='d-flex align-items-center pe-3 py-2'>\n                  <div>\n                    <Skeleton circle width={40} height={40} />\n                  </div>\n                  <div className='w-100 ps-3'>\n                    <Skeleton count={3} />\n                  </div>\n                </div>\n              ))}\n        </ul>\n      </div>\n    </div>\n  )\n}\n","import './post.css'\nimport { MoreVert } from '@material-ui/icons'\nimport { useContext, useEffect, useState } from 'react'\nimport { format } from 'timeago.js'\nimport { Link, useHistory } from 'react-router-dom'\nimport { AuthContext } from '../../context/Auth'\nimport { Menu, Dropdown, message } from 'antd'\nimport { getUserById, likePost, deletePost } from '../../apiCalls'\n\nexport default function Post({\n  post,\n  fetchPosts,\n  differentUser = false,\n  index,\n}) {\n  const [like, setLike] = useState(post.likes.length)\n  const [isLiked, setIsLiked] = useState(false)\n  const [user, setUser] = useState({})\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER\n  const { user: currentUser } = useContext(AuthContext)\n  const history = useHistory()\n\n  useEffect(() => {\n    setIsLiked(post.likes.includes(currentUser._id))\n  }, [currentUser._id, post.likes])\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      getUserById(post.userId)\n        .then((res) => {\n          setUser(res.data)\n        })\n        .catch((err) => console.log(err))\n    }\n    fetchUser()\n  }, [post.userId])\n\n  const likeHandler = () => {\n    try {\n      likePost({ _id: post._id, payload: { userId: currentUser._id } })\n    } catch (err) {}\n    setLike(isLiked ? like - 1 : like + 1)\n    setIsLiked(!isLiked)\n  }\n\n  const deleteHandler = async () => {\n    deletePost({ _id: post._id })\n      .then((res) => {\n        message.success('Post deleted successfully.')\n        fetchPosts()\n      })\n      .catch((err) => {\n        message.error('Something went wrong!')\n      })\n  }\n\n  const menu = (\n    <Menu>\n      <Menu.Item>\n        <span onClick={deleteHandler}>Delete</span>\n      </Menu.Item>\n    </Menu>\n  )\n\n  return (\n    <div className={`post ${differentUser && index === 0 ? 'firstPost' : ''}`}>\n      <div className='postWrapper'>\n        <div className='postTop'>\n          <div className='postTopLeft'>\n            <Link to={`/profile/${user.username}`}>\n              <img\n                className='postProfileImg'\n                src={\n                  user.profilePicture\n                    ? user.profilePicture\n                    : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n                }\n                alt=''\n              />\n            </Link>\n            <span\n              className='postUsername'\n              onClick={() => history.push(`/profile/${user.username}`)}\n            >\n              {user.username}\n            </span>\n            <span className='postDate'>{format(post.createdAt)}</span>\n          </div>\n          {post?.userId === currentUser?._id && (\n            <div className='postTopRight' style={{ cursor: 'pointer' }}>\n              <Dropdown overlay={menu}>\n                <MoreVert />\n              </Dropdown>\n            </div>\n          )}\n        </div>\n        <div className='postCenter'>\n          <span className='postText'>{post?.desc}</span>\n          {post.img && <img className='postImg' src={post.img} alt='' />}\n        </div>\n        <div className='postBottom'>\n          <div className='postBottomLeft'>\n            <img\n              className='likeIcon'\n              src={`${PF}like.png`}\n              onClick={likeHandler}\n              alt=''\n            />\n            {/* <img\n              className=\"likeIcon\"\n              src={`${PF}heart.png`}\n              onClick={likeHandler}\n              alt=\"\"\n            /> */}\n            <span className='postLikeCounter'>{like} people like it</span>\n          </div>\n          {/* <div className=\"postBottomRight\">\n            <span className=\"postCommentText\">{post.comment} comments</span>\n          </div> */}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import axios from 'axios'\nconst AWS = require('aws-sdk')\nconst config = {\n  secretAccessKey: 'aHOzpUp3nCoHyYL3rGRsejyjNPC94psK1nvUcgat',\n  accessKeyId: 'AKIA3JPVUL47F5NR5XMG',\n  region: 'ap-south-1',\n}\nAWS.config = config\nconst s3bucket = new AWS.S3()\nvar bucketName = 'social-app-assets'\n\nexport const upload = (file, cb = () => {}) => {\n  try {\n    const fileName = `${file?.name}-${new Date().getTime()}`\n    var params = {\n      Bucket: bucketName,\n      Key: fileName,\n      Expires: 90000,\n      ContentType: file.type,\n      ACL: 'public-read',\n    }\n    s3bucket.getSignedUrl('putObject', params, function (err, data) {\n      if (err) {\n        return cb(err)\n      }\n      var options = {\n        headers: {\n          'Content-Type': file.type,\n        },\n      }\n      // const url = `https://s3.ap-south-1.amazonaws.com/${bucketName}/${fileName}`\n      const url = `${\n        process.env.CLOUDFRONT_ASSETS_URL ||\n        'https://d225jocw4xhwve.cloudfront.net'\n      }/${fileName}`\n      axios\n        .put(data, file, options)\n        .then(() => cb(false, url))\n        .catch((err) => cb(err))\n    })\n  } catch (err) {\n    console.log({ err })\n  }\n}\n","import './share.css'\nimport {\n  PermMedia,\n  // Label,\n  // Room,\n  // EmojiEmotions,\n  Cancel,\n} from '@material-ui/icons'\nimport { useContext, useRef, useState } from 'react'\nimport { AuthContext } from '../../context/Auth'\nimport axios from 'axios'\nimport { message } from 'antd'\nimport { upload } from '../../utils/upload'\nimport { POSTS_BASE_URL } from '../../utils/connections'\n\nexport default function Share({ fetchPosts }) {\n  const { user } = useContext(AuthContext)\n  const desc = useRef()\n  const imageRef = useRef()\n  const [file, setFile] = useState(null)\n\n  const uploadPost = (payload) => {\n    axios\n      .post(POSTS_BASE_URL, payload)\n      .then((res) => {\n        message.success('New Post Uploaded')\n        fetchPosts()\n      })\n      .catch((err) => {\n        message.error(err?.data || 'Please try again later.')\n      })\n  }\n\n  const submitHandler = async (e) => {\n    e.preventDefault()\n    let payload = {\n      userId: user._id,\n      desc: desc.current.value,\n    }\n    if (file) {\n      try {\n        upload(file, (err, response) => {\n          if (!err) {\n            payload.img = response\n            uploadPost(payload)\n          } else {\n            message.error(err?.message || 'Please try again later.')\n          }\n        })\n      } catch (err) {}\n    } else {\n      if (desc.current.value.length > 0) {\n        uploadPost(payload)\n      } else {\n        message.warning(\"You can't upload a blank post.\")\n      }\n    }\n    desc.current.value = ''\n    setFile(null)\n  }\n\n  return (\n    <div className='share'>\n      <div className='shareWrapper'>\n        <div className='shareTop'>\n          <img\n            className='shareProfileImg'\n            src={\n              user.profilePicture\n                ? user.profilePicture\n                : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n            }\n            alt=''\n          />\n          <textarea\n            placeholder={\"What's in your mind \" + user.username + '?'}\n            className='shareInput'\n            ref={desc}\n          />\n        </div>\n        <hr className='shareHr' />\n        {file && (\n          <div className='shareImgContainer'>\n            <img className='shareImg' src={URL.createObjectURL(file)} alt='' />\n            <Cancel\n              className='shareCancelImg'\n              onClick={() => {\n                setFile(null)\n                imageRef.current.value = null\n              }}\n            />\n          </div>\n        )}\n        <form className='shareBottom' onSubmit={submitHandler}>\n          <div className='shareOptions'>\n            <label htmlFor='feedPost' className='shareOption'>\n              <PermMedia htmlColor='tomato' className='shareIcon' />\n              <span className='shareOptionText'>Photo or Video</span>\n              <input\n                style={{ display: 'none' }}\n                type='file'\n                ref={imageRef}\n                id='feedPost'\n                accept='.png,.jpeg,.jpg'\n                onChange={(e) => setFile(e.target.files[0])}\n              />\n            </label>\n            {/* <div className=\"shareOption\">\n              <Label htmlColor=\"blue\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Tag</span>\n            </div>\n            <div className=\"shareOption\">\n              <Room htmlColor=\"green\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Location</span>\n            </div>\n            <div className=\"shareOption\">\n              <EmojiEmotions htmlColor=\"goldenrod\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Feelings</span>\n            </div> */}\n          </div>\n          <button className='shareButton' type='submit'>\n            Share\n          </button>\n        </form>\n      </div>\n    </div>\n  )\n}\n","import { useContext, useEffect, useState } from 'react'\nimport Skeleton from 'react-loading-skeleton'\nimport Post from '../post/Post'\nimport Share from '../share/Share'\nimport './feed.css'\nimport axios from 'axios'\nimport { AuthContext } from '../../context/Auth'\nimport { POSTS_BASE_URL } from '../../utils/connections'\n\nexport default function Feed({ username, user: userProps }) {\n  const [posts, setPosts] = useState([])\n  const [loadingPosts, setLoadingPosts] = useState(true)\n  const { user } = useContext(AuthContext)\n\n  const fetchPosts = async () => {\n    setLoadingPosts(true)\n    try {\n      const res = username\n        ? await axios.get(`${POSTS_BASE_URL}/profile/` + username)\n        : await axios.get(`${POSTS_BASE_URL}/timeline/` + user._id)\n      setPosts(\n        res.data.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt)\n        })\n      )\n      setLoadingPosts(false)\n    } catch (error) {\n      setLoadingPosts(false)\n    }\n  }\n\n  useEffect(() => {\n    fetchPosts()\n    // eslint-disable-next-line\n  }, [username, user._id, userProps])\n\n  return (\n    <div className='feed'>\n      <div className='feedWrapper'>\n        {(!username || username === user.username) && (\n          <Share fetchPosts={fetchPosts} />\n        )}\n\n        {!loadingPosts ? (\n          posts && posts.length > 0 ? (\n            posts.map((p, i) => (\n              <Post\n                fetchPosts={fetchPosts}\n                key={p._id}\n                post={p}\n                index={i}\n                differentUser={userProps ? userProps?._id !== user._id : false}\n              />\n            ))\n          ) : (\n            <h3 className='noPostHeading'>\n              {userProps\n                ? userProps?._id !== user._id\n                  ? '@' + userProps?.username\n                  : 'You'\n                : 'You'}{' '}\n              have not post anything yet!\n            </h3>\n          )\n        ) : (\n          [...Array(2).keys()].map((el, i) => (\n            <div key={i} className='mt-3'>\n              <div className='d-flex align-items-center pe-3 py-2'>\n                <div>\n                  <Skeleton circle width={40} height={40} />\n                </div>\n                <div className='ps-3'>\n                  <Skeleton count={2} width={200} />\n                </div>\n                <div className='w-100 ps-3'>\n                  <Skeleton width={100} />\n                </div>\n              </div>\n              <Skeleton count={2} />\n              <Skeleton height={180} />\n              <div className='d-flex align-items-center pe-3 py-2'>\n                <div>\n                  <Skeleton circle width={40} height={40} />\n                </div>\n                <div className='ps-3'>\n                  <Skeleton width={200} />\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Modal, Button, Form, Col } from 'react-bootstrap'\n\nexport default function UserInfo({ show, handleClose, handleSubmit, user }) {\n  const [validated, setValidated] = useState(false)\n  const [state, setState] = useState({\n    firstName: '',\n    lastName: '',\n    city: '',\n  })\n\n  useEffect(() => {\n    user &&\n      setState((prev) => ({\n        ...prev,\n        ...user,\n      }))\n  }, [user])\n\n  const checkValidation = (event) => {\n    const form = event.currentTarget\n    event.preventDefault()\n    if (form.checkValidity() === false) {\n      event.stopPropagation()\n    }\n\n    setValidated(true)\n    handleSubmit(state)\n  }\n\n  return (\n    <Modal show={show} onHide={handleClose}>\n      <Modal.Header closeButton>\n        <Modal.Title>User information</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form noValidate validated={validated} onSubmit={checkValidation}>\n          <Form.Group as={Col} className='mb-3' controlId='firstName'>\n            <Form.Label>First name</Form.Label>\n            <Form.Control\n              required\n              type='text'\n              minLength={5}\n              placeholder='First name'\n              name='firstName'\n              value={state.firstName}\n              onChange={(event) =>\n                setState({ ...state, [event.target.name]: event.target.value })\n              }\n              //   defaultValue=\"Mark\"\n            />\n            <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\n            <Form.Control.Feedback type='invalid'>\n              Please provide a valid First name.\n            </Form.Control.Feedback>\n          </Form.Group>\n          <Form.Group as={Col} className='mb-3' controlId='lastName'>\n            <Form.Label>Last name</Form.Label>\n            <Form.Control\n              required\n              type='text'\n              minLength={5}\n              placeholder='Last name'\n              name='lastName'\n              value={state.lastName}\n              onChange={(event) =>\n                setState({ ...state, [event.target.name]: event.target.value })\n              }\n              //   defaultValue=\"Otto\"\n            />\n            <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\n            <Form.Control.Feedback type='invalid'>\n              Please provide a valid First name.\n            </Form.Control.Feedback>\n          </Form.Group>\n          <Form.Group as={Col} className='mb-3' controlId='city'>\n            <Form.Label>City</Form.Label>\n            <Form.Control\n              name='city'\n              type='text'\n              placeholder='City'\n              required\n              value={state.city}\n              onChange={(event) =>\n                setState({ ...state, [event.target.name]: event.target.value })\n              }\n            />\n            <Form.Control.Feedback type='invalid'>\n              Please provide a valid city.\n            </Form.Control.Feedback>\n          </Form.Group>\n          <div className='d-flex'>\n            <Button variant='secondary' onClick={handleClose}>\n              Close\n            </Button>\n            <Button\n              variant='primary'\n              style={{ marginLeft: '12px' }}\n              onClick={handleSubmit}\n              type='submit'\n            >\n              Save Changes\n            </Button>\n          </div>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  )\n}\n","import './rightbar.css'\nimport Online from '../online/Online'\nimport { useContext, useEffect, useState } from 'react'\nimport { message } from 'antd'\nimport { Link, useHistory } from 'react-router-dom'\nimport Skeleton from 'react-loading-skeleton'\nimport { AuthContext } from '../../context/Auth'\nimport { Add, Remove, Edit, Chat } from '@material-ui/icons'\nimport UserInfoModal from '../modals/userInfo'\nimport {\n  getFriends as getUserFriends,\n  getFriendsByUserName,\n  follow,\n  unfollow,\n} from '../../apiCalls'\n\nexport default function Rightbar({\n  user,\n  onlineFriends,\n  UpdateUserDetails = () => {},\n  loadingFriends,\n  loadingUserDetails = false,\n  mobileView,\n}) {\n  const [friends, setFriends] = useState([])\n  const history = useHistory()\n  const { user: currentUser, dispatch } = useContext(AuthContext)\n  const [followed, setFollowed] = useState(\n    currentUser.followings.includes(user?._id)\n  )\n\n  useEffect(() => {\n    setFollowed(currentUser.followings.includes(user?._id))\n  }, [currentUser, user])\n\n  useEffect(() => {\n    const getFriends = async () => {\n      if (user && user.username) {\n        try {\n          const friendList = await getFriendsByUserName(user.username)\n          setFriends(friendList.data)\n        } catch (err) {\n          console.log(err)\n        }\n      } else {\n        try {\n          const friendList = await getUserFriends(currentUser?._id)\n          setFriends(friendList.data)\n        } catch (err) {\n          console.log(err)\n        }\n      }\n    }\n    getFriends()\n  }, [currentUser?._id, user])\n\n  const handleClick = async () => {\n    try {\n      if (followed) {\n        unfollow(user._id, currentUser._id)\n          .then((res) => {\n            message.success('User has been unfollowed.')\n            dispatch({ type: 'UNFOLLOW', payload: user._id })\n          })\n          .catch((err) => {\n            console.log(err)\n            message.error('Something went wrong!')\n          })\n      } else {\n        follow(user._id, currentUser._id)\n          .then((res) => {\n            message.success('User has been followed.')\n            dispatch({ type: 'FOLLOW', payload: user._id })\n          })\n          .catch((err) => {\n            console.log(err)\n            message.error('Something went wrong!')\n          })\n      }\n      setFollowed(!followed)\n    } catch (err) {}\n  }\n\n  const HomeRightbar = () => {\n    return (\n      <>\n        {/* <div className=\"birthdayContainer\">\n          <img className=\"birthdayImg\" src=\"assets/gift.png\" alt=\"\" />\n          <span className=\"birthdayText\">\n            <b>Pola Foster</b> and <b>3 other friends</b> have a birhday today.\n          </span>\n        </div> */}\n        <img className='rightbarAd' src='assets/ad.png' alt='' />\n        {onlineFriends?.length > 0 && (\n          <h4 className='rightbarTitle'>Online Friends</h4>\n        )}\n        <ul className='rightbarFriendList'>\n          {!loadingFriends\n            ? onlineFriends?.map((u) => (\n                <div\n                  key={u._id}\n                  onClick={() => history.push(`/messenger?q=${u._id}`)}\n                  style={{ cursor: 'pointer' }}\n                >\n                  <Online key={u._id} user={u} />\n                </div>\n              ))\n            : [...Array(3).keys()].map((el, i) => (\n                <div key={i} className='d-flex align-items-center pe-3 py-2'>\n                  <div>\n                    <Skeleton circle width={40} height={40} />\n                  </div>\n                  <div className='w-100 ps-3'>\n                    <Skeleton count={3} />\n                  </div>\n                </div>\n              ))}\n        </ul>\n      </>\n    )\n  }\n\n  const ProfileRightbar = () => {\n    const [show, setShow] = useState(false)\n\n    const handleClose = () => setShow(false)\n    const handleShow = () => setShow(true)\n    const handleSubmit = (state) => {\n      try {\n        UpdateUserDetails(state, (err) => {\n          if (!err) handleClose()\n        })\n      } catch (err) {\n        console.log(err)\n      }\n    }\n\n    return (\n      <>\n        {!loadingUserDetails ? (\n          <>\n            <div className='d-flex align-items-center'>\n              {user.username !== currentUser.username && (\n                <button className='rightbarFollowButton' onClick={handleClick}>\n                  {followed ? 'Unfollow' : 'Follow'}\n                  {followed ? <Remove /> : <Add />}\n                </button>\n              )}\n              {followed && (\n                <button\n                  className='rightbarFollowButton ms-3'\n                  onClick={() => history.push(`/messenger?q=${user?._id}`)}\n                  title='Send Message'\n                >\n                  <Chat />\n                </button>\n              )}\n            </div>\n            <div className='profileEditContainer'>\n              <div className='d-flex flex-column'>\n                <h4 className='profileInfoName'>\n                  <strong>{user.username && `@${user.username}`}</strong>\n                </h4>\n                <h4 className='rightbarTitle'>User information</h4>\n              </div>\n              {user.username === currentUser.username && (\n                <button className='editButton' onClick={handleShow}>\n                  <Edit />\n                  {'Edit profile'}\n                </button>\n              )}\n            </div>\n            <div className='rightbarInfo'>\n              <div className='rightbarInfoItem'>\n                <span className='rightbarInfoKey'>First Name:</span>\n                <span className='rightbarInfoValue'>\n                  {user.firstName || 'N/A'}\n                </span>\n              </div>\n              <div className='rightbarInfoItem'>\n                <span className='rightbarInfoKey'>Last Name:</span>\n                <span className='rightbarInfoValue'>\n                  {user.lastName || 'N/A'}\n                </span>\n              </div>\n              <div className='rightbarInfoItem'>\n                <span className='rightbarInfoKey'>City:</span>\n                <span className='rightbarInfoValue'>{user.city || 'N/A'}</span>\n              </div>\n            </div>\n            <h4 className='rightbarTitle'>User friends</h4>\n            <div className='rightbarFollowings'>\n              {friends.map((friend) => (\n                <Link\n                  key={friend.username}\n                  to={'/profile/' + friend.username}\n                  style={{ textDecoration: 'none' }}\n                >\n                  <div className='rightbarFollowing'>\n                    <img\n                      src={\n                        friend.profilePicture\n                          ? friend.profilePicture\n                          : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n                      }\n                      alt=''\n                      className='rightbarFollowingImg'\n                    />\n                    <span className='rightbarFollowingName text-center'>\n                      {friend.username}\n                    </span>\n                  </div>\n                </Link>\n              ))}\n            </div>\n          </>\n        ) : (\n          <div>\n            <div className='d-flex align-items-center pe-3 py-2'>\n              <div>\n                <Skeleton width={200} count={2} />\n              </div>\n              <div className='w-100 ps-3'>\n                <Skeleton height={36} />\n              </div>\n            </div>\n            <Skeleton count={3} width={200} />\n            <Skeleton count={6} />\n          </div>\n        )}\n\n        <UserInfoModal\n          show={show}\n          user={user}\n          handleClose={handleClose}\n          handleSubmit={handleSubmit}\n        />\n      </>\n    )\n  }\n  return (\n    <div className={mobileView ? 'rightbarMobile' : 'rightbar'}>\n      <div className='rightbarWrapper'>\n        {user ? <ProfileRightbar /> : <HomeRightbar />}\n      </div>\n    </div>\n  )\n}\n","import { useState, useEffect, useContext } from 'react'\nimport Topbar from '../../components/topbar/Topbar'\nimport Sidebar from '../../components/sidebar/Sidebar'\nimport Feed from '../../components/feed/Feed'\nimport Rightbar from '../../components/rightbar/Rightbar'\nimport { AuthContext } from '../../context/Auth'\nimport { SocketContext } from '../../context/Socket'\nimport './home.css'\nimport { useHistory } from 'react-router'\nimport { getFriends } from '../../apiCalls'\n\nexport default function Home() {\n  const history = useHistory()\n  const { user } = useContext(AuthContext)\n  const { onlineUsers } = useContext(SocketContext)\n  const [friends, setFriends] = useState([])\n  const [onlineFriends, setOnlineFriends] = useState([])\n  const [loadingFriends, setLoadingFriends] = useState(true)\n\n  useEffect(() => {\n    if (!user) {\n      history.push('/')\n    }\n  }, [user, history])\n\n  useEffect(() => {\n    setLoadingFriends(true)\n    getFriends(user._id)\n      .then((res) => {\n        setFriends(res.data)\n        setLoadingFriends(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingFriends(false)\n      })\n  }, [user])\n\n  useEffect(() => {\n    setOnlineFriends(friends.filter((el) => onlineUsers?.includes(el._id)))\n  }, [onlineUsers, friends])\n\n  return (\n    <>\n      <Topbar />\n      <div className='homeContainer'>\n        <Sidebar />\n        <Feed />\n        <Rightbar\n          onlineFriends={onlineFriends}\n          friends={friends}\n          loadingFriends={loadingFriends}\n        />\n      </div>\n    </>\n  )\n}\n","import { useContext, useRef } from 'react'\nimport './login.css'\nimport { loginCall } from '../../apiCalls'\nimport { AuthContext } from '../../context/Auth'\nimport { CircularProgress } from '@material-ui/core'\nimport { useHistory } from 'react-router-dom'\n\nexport default function Login() {\n  const history = useHistory()\n  const email = useRef()\n  const password = useRef()\n  const { isFetching, dispatch } = useContext(AuthContext)\n\n  const handleClick = (e) => {\n    e.preventDefault()\n    loginCall(\n      { email: email.current.value, password: password.current.value },\n      dispatch\n    )\n  }\n\n  return (\n    <div className='login'>\n      <div className='loginWrapper row align-items-center'>\n        <div className='loginLeft col-md-6'>\n          <h3 className='loginLogo'>ViaChat</h3>\n          <span className='loginDesc'>\n            Connect with friends and the world around you on ViaChat.\n          </span>\n        </div>\n        <div className='loginRight col-md-6'>\n          <form className='loginBox' onSubmit={handleClick}>\n            <input\n              placeholder='Email'\n              type='email'\n              name='email'\n              required\n              className='loginInput'\n              ref={email}\n            />\n            <input\n              placeholder='Password'\n              type='password'\n              name='password'\n              required\n              minLength='6'\n              className='loginInput'\n              ref={password}\n            />\n            <button className='loginButton' type='submit' disabled={isFetching}>\n              {isFetching ? (\n                <CircularProgress color='white' size='20px' />\n              ) : (\n                'Log In'\n              )}\n            </button>\n            {/* <span className='loginForgot'>Forgot Password?</span> */}\n            <button\n              className='loginRegisterButton'\n              onClick={() => history.push('/')}\n              disabled={isFetching}\n            >\n              {isFetching ? (\n                <CircularProgress color='white' size='20px' />\n              ) : (\n                'Create a New Account'\n              )}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import './profile.css'\nimport Topbar from '../../components/topbar/Topbar'\nimport Sidebar from '../../components/sidebar/Sidebar'\nimport Feed from '../../components/feed/Feed'\nimport Rightbar from '../../components/rightbar/Rightbar'\nimport { useEffect, useState, useContext } from 'react'\nimport { useParams } from 'react-router'\nimport { AuthContext } from '../../context/Auth'\nimport { getFriends, updateUser, getUserByUsername } from '../../apiCalls'\nimport { CameraAlt, Edit } from '@material-ui/icons'\nimport { upload } from '../../utils/upload'\nimport { message } from 'antd'\nimport { Spinner } from 'react-bootstrap'\nimport useWindowSize from '../../utils/windowSize'\n\nexport default function Profile() {\n  const [user, setUser] = useState({})\n  const width = useWindowSize()\n  const { user: loggedInUser, dispatch } = useContext(AuthContext)\n  const [loading, setLoading] = useState({\n    coverPicture: false,\n    profilePicture: false,\n  })\n  const [loadingUserDetails, setLoadingUserDetails] = useState(false)\n  const [friends, setFriends] = useState([])\n  const username = useParams().username\n\n  useEffect(() => {\n    setLoadingUserDetails(true)\n    const fetchUser = async () => {\n      getUserByUsername(username)\n        .then((res) => {\n          setUser(res.data)\n        })\n        .catch((err) => console.log(err))\n    }\n    fetchUser()\n    setLoadingUserDetails(false)\n  }, [username])\n\n  useEffect(() => {\n    getFriends(loggedInUser._id)\n      .then((res) => {\n        setFriends(res.data)\n      })\n      .catch((err) => console.log(err))\n  }, [loggedInUser._id])\n\n  const UpdateUserDetails = (state, cb = () => {}) => [\n    updateUser({ ...state, userId: user._id })\n      .then((res) => {\n        cb(false, res)\n        setUser(res.data.data)\n        dispatch({ type: 'UPDATE', payload: res.data.data })\n        setLoading({ coverPicture: false, profilePicture: false })\n        message.success(res?.data?.message || 'Profile updated successfully.')\n      })\n      .catch((err) => {\n        console.log(err)\n      }),\n  ]\n\n  const handleFileUpload = (file, name) => {\n    upload(file, (err, response) => {\n      if (!err) {\n        setLoading({ ...loading, [name]: true })\n        UpdateUserDetails({ ...loggedInUser, [name]: response })\n      } else {\n        message.error(err?.message || 'Something went wrong!')\n      }\n    })\n  }\n\n  return (\n    <>\n      <Topbar />\n      <div className='profile'>\n        <Sidebar friends={friends} />\n        <div className='profileRight'>\n          <div className='profileRightTop'>\n            <div className='profileCover'>\n              <div>\n                <img\n                  className='profileCoverImg'\n                  src={\n                    user.coverPicture\n                      ? user.coverPicture.replace(\n                          's3.ap-south-1.amazonaws.com/social-app-assets',\n                          'd225jocw4xhwve.cloudfront.net'\n                        )\n                      : 'https://d225jocw4xhwve.cloudfront.net/pexels-lina-kivaka-2337491.jpg'\n                  }\n                  alt=''\n                />\n                {loading.coverPicture && (\n                  <Spinner animation='border' variant='primary' />\n                )}\n                {user.username === loggedInUser.username && (\n                  <div>\n                    <label htmlFor='cover' className='shareOption'>\n                      <div className='editCoverImage'>\n                        <Edit />\n                        {width > 510 && 'Edit Cover Photo'}\n                      </div>\n                      <input\n                        style={{ display: 'none' }}\n                        type='file'\n                        id='cover'\n                        accept='.png,.jpeg,.jpg'\n                        onChange={(e) =>\n                          handleFileUpload(e.target.files[0], 'coverPicture')\n                        }\n                      />\n                    </label>\n                  </div>\n                )}\n              </div>\n              <div className='profileUserImgContainer'>\n                {loading.profilePicture ? (\n                  <Spinner\n                    animation='border'\n                    className='profileUserImg'\n                    variant='primary'\n                  />\n                ) : (\n                  <img\n                    className='profileUserImg'\n                    src={\n                      user.profilePicture\n                        ? user.profilePicture\n                        : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n                    }\n                    alt=''\n                  />\n                )}\n                {user.username === loggedInUser.username && (\n                  <div>\n                    <label htmlFor='file' className='shareOption'>\n                      <div className='editProfileImage'>\n                        <CameraAlt style={{ fontSize: '20px' }}></CameraAlt>\n                      </div>\n                      <input\n                        style={{ display: 'none' }}\n                        type='file'\n                        id='file'\n                        accept='.png,.jpeg,.jpg'\n                        onChange={(e) =>\n                          handleFileUpload(e.target.files[0], 'profilePicture')\n                        }\n                      />\n                    </label>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n          <Rightbar\n            user={user}\n            UpdateUserDetails={UpdateUserDetails}\n            loadingUserDetails={loadingUserDetails}\n            mobileView\n          />\n          <div className='profileRightBottom'>\n            <Feed username={username} user={user} />\n            <Rightbar\n              user={user}\n              UpdateUserDetails={UpdateUserDetails}\n              loadingUserDetails={loadingUserDetails}\n            />\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n","import { useRef, useContext, useState } from 'react'\nimport './register.css'\nimport { useHistory } from 'react-router'\nimport { CircularProgress } from '@material-ui/core'\nimport { GenerateKeys } from '../../utils/crypto'\nimport { message } from 'antd'\nimport { RegisterCall } from '../../apiCalls'\nimport { AuthContext } from '../../context/Auth'\n\nexport default function Register() {\n  const username = useRef()\n  const email = useRef()\n  const password = useRef()\n  const passwordAgain = useRef()\n  const history = useHistory()\n  const { dispatch } = useContext(AuthContext)\n  const [loading, setLoading] = useState(false)\n\n  const handleClick = async (e) => {\n    setLoading(true)\n    e.preventDefault()\n    if (passwordAgain.current.value !== password.current.value) {\n      message.warning(\"Passwords don't match!\")\n      setLoading(false)\n    } else {\n      const keys = await GenerateKeys()\n      const user = {\n        username: username.current.value,\n        email: email.current.value,\n        password: password.current.value,\n        ...keys,\n      }\n      RegisterCall(user, dispatch)\n        .then((res) => {\n          message.success(\n            'Registration done successfully. Please login to continue.'\n          )\n          setLoading(false)\n          history.push('/login')\n        })\n        .catch((err) => {\n          console.log(err)\n          setLoading(false)\n          message.error(err?.response?.data || 'Something went wrong!')\n        })\n    }\n  }\n\n  return (\n    <div className='login'>\n      <div className='loginWrapper row align-items-center'>\n        <div className='loginLeft col-md-6'>\n          <h3 className='loginLogo'>ViaChat</h3>\n          <span className='loginDesc'>\n            Connect with friends and the world around you on ViaChat.\n          </span>\n        </div>\n        <div className='loginRight col-md-6'>\n          <form className='loginBox' onSubmit={handleClick}>\n            <input\n              placeholder='Username'\n              required\n              ref={username}\n              name='username'\n              className='loginInput'\n            />\n            <input\n              placeholder='Email'\n              required\n              ref={email}\n              name='email'\n              className='loginInput'\n              type='email'\n            />\n            <input\n              placeholder='Password'\n              required\n              ref={password}\n              name='password'\n              className='loginInput'\n              type='password'\n              minLength='6'\n            />\n            <input\n              placeholder='Confirm Password'\n              required\n              ref={passwordAgain}\n              name='passwordAgain'\n              className='loginInput'\n              type='password'\n            />\n            <button className='loginButton' type='submit' disabled={loading}>\n              {loading ? (\n                <CircularProgress color='white' size='20px' />\n              ) : (\n                'Sign Up'\n              )}\n            </button>\n            <button\n              className='loginRegisterButton'\n              onClick={() => history.push('/login')}\n              disabled={loading}\n            >\n              {loading ? (\n                <CircularProgress color='white' size='20px' />\n              ) : (\n                'Log into Account'\n              )}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport { getUserById } from '../../apiCalls'\nimport './conversation.css'\n\nconst Conversation = ({\n  conversation,\n  currentUser,\n  setAllConversations,\n  AllConversations,\n}) => {\n  const [user, setUser] = useState(null)\n\n  useEffect(() => {\n    const friendId = conversation.members?.find((el) => el !== currentUser._id)\n\n    getUserById(friendId)\n      .then((res) => {\n        setUser(res.data)\n        const newConversations = AllConversations.map((el) => {\n          if (el.members.includes(res.data._id)) el.member = res.data\n          return el\n        })\n        setAllConversations(newConversations)\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n    // eslint-disable-next-line\n  }, [currentUser, conversation])\n\n  return (\n    <div className='conversation'>\n      <img\n        className='conversationImg'\n        src={\n          user?.profilePicture\n            ? user?.profilePicture\n            : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n        }\n        alt='profileImage'\n      />\n      <span className='conversationName'>{user?.username}</span>\n    </div>\n  )\n}\n\nexport default Conversation\n","import React, { useContext } from 'react'\nimport { format } from 'timeago.js'\nimport { AuthContext } from '../../context/Auth'\nimport './message.css'\n\nconst Message = ({\n  message,\n  own,\n  Decrypt,\n  derivedKeys,\n  friend,\n  encryptMessages,\n  setSendFile = () => {},\n  setIsVisible = () => {},\n}) => {\n  const [state, setState] = React.useState('')\n  const { user } = useContext(AuthContext)\n  React.useEffect(() => {\n    const getMessages = async () => {\n      const decryptedMessage = await Decrypt(message.text, derivedKeys)\n      setState(decryptedMessage)\n    }\n    getMessages()\n    // eslint-disable-next-line\n  }, [message, derivedKeys])\n\n  return (\n    <div className={`message${own ? ' own' : ''}`}>\n      <div className='messageTop'>\n        <img\n          className='messageImg'\n          src={\n            own\n              ? user?.profilePicture\n                ? user?.profilePicture\n                : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n              : friend?.profilePicture\n              ? friend?.profilePicture\n              : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n          }\n          alt='profileImage'\n        />\n        {state.startsWith('http') &&\n        (state.includes('.png') ||\n          state.includes('.jpeg') ||\n          state.includes('.jpg')) &&\n        !encryptMessages ? (\n          <img\n            className='imgInChat'\n            src={state}\n            alt=''\n            onClick={() => {\n              setSendFile(state)\n              setIsVisible(true)\n            }}\n          />\n        ) : (\n          <p className='messageText'>\n            {encryptMessages ? message.text : state}\n          </p>\n        )}\n      </div>\n      <div className='messageBottom'>{format(message.createdAt)}</div>\n    </div>\n  )\n}\n\nexport default Message\n","import React, { useEffect, useState } from 'react'\nimport Skeleton from 'react-loading-skeleton'\nimport { getConversationByOfTwoUsers, getFriends } from '../../apiCalls'\nimport './chatOnline.css'\n\nconst ChatOnline = ({\n  onlineUsers,\n  currentId,\n  setCurrentChat,\n  updateConversations = () => {},\n}) => {\n  const [friends, setFriends] = useState([])\n  const [onlineFriends, setOnlineFriends] = useState([])\n  const [loadingFriends, setLoadingFriends] = useState(true)\n\n  useEffect(() => {\n    setLoadingFriends(true)\n    getFriends(currentId)\n      .then((res) => {\n        setFriends(res.data)\n        setLoadingFriends(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingFriends(false)\n      })\n  }, [currentId])\n\n  useEffect(() => {\n    setOnlineFriends(friends.filter((el) => onlineUsers?.includes(el._id)))\n  }, [onlineUsers, friends])\n\n  const openUserChat = (userId) => {\n    getConversationByOfTwoUsers(currentId, userId)\n      .then((res) => {\n        if (res.data.new)\n          updateConversations({\n            senderId: currentId,\n            receiverId: userId,\n            conversation: res.data.data,\n          })\n        setCurrentChat(res.data.data)\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n  }\n\n  const checkUserOnline = (id) => {\n    return onlineFriends.some((el) => el._id === id)\n  }\n\n  return (\n    <div className='chatOnline'>\n      {!loadingFriends ? (\n        friends.length > 0 ? (\n          friends.map((el, i) => (\n            <div\n              key={i}\n              className='chatOnlineFriend'\n              onClick={() => openUserChat(el._id)}\n            >\n              <div className='chatOnlineImgContainer'>\n                <img\n                  className='chatOnlineImg'\n                  src={\n                    el?.profilePicture\n                      ? el?.profilePicture\n                      : 'https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png'\n                  }\n                  alt='profileImage'\n                />\n                <div\n                  className={`chatOnlineBadge${\n                    checkUserOnline(el._id) ? ' online' : ''\n                  }`}\n                ></div>\n              </div>\n              <span className='chatOnlineName'>{el.username}</span>\n            </div>\n          ))\n        ) : (\n          <span className='noChatText'>You don't have any friends yet.</span>\n        )\n      ) : (\n        [...Array(3).keys()].map((el, i) => (\n          <div key={i} className='d-flex align-items-center ps-2 pe-3 py-2'>\n            <div>\n              <Skeleton circle width={40} height={40} />\n            </div>\n            <div className='w-100 ps-3'>\n              <Skeleton count={3} />\n            </div>\n          </div>\n        ))\n      )}\n    </div>\n  )\n}\n\nexport default ChatOnline\n","import React, { useContext, useState, useEffect, useRef } from 'react'\nimport './messenger.css'\nimport Topbar from '../../components/topbar/Topbar'\nimport Conversation from '../../components/conversation/Conversation'\nimport Message from '../../components/message/Message'\nimport ChatOnline from '../../components/chatOnline/ChatOnline'\nimport { AuthContext } from '../../context/Auth'\nimport { SocketContext } from '../../context/Socket'\nimport useSocket from '../../utils/socket'\nimport {\n  getConversations,\n  getMessages,\n  sendNewMessage,\n  getUserById,\n  getConversationByOfTwoUsers,\n} from '../../apiCalls'\nimport { setArrivalMessage } from '../../context/Socket/SocketActions'\nimport { Encrypt, Decrypt, DeriveKeys } from '../../utils/crypto'\nimport Skeleton from 'react-loading-skeleton'\nimport { message, Switch, Tooltip, Upload, Modal } from 'antd'\nimport { useLocation } from 'react-router'\nimport KeyboardBackspaceIcon from '@material-ui/icons/KeyboardBackspace'\nimport useWindowSize from '../../utils/windowSize'\nimport { IconButton } from '@material-ui/core'\nimport SendIcon from '@material-ui/icons/Send'\nimport AttachFileIcon from '@material-ui/icons/AttachFile'\nimport { upload } from '../../utils/upload'\n\nconst Messenger = () => {\n  const { socket } = useSocket()\n  const [AllConversations, setAllConversations] = useState([])\n  const [conversations, setConversations] = useState([])\n  const [currentChat, setCurrentChat] = useState(null)\n  const [messages, setMessages] = useState([])\n  const [friend, setFriend] = useState(null)\n  const [newMessage, setNewMessage] = useState('')\n  const [decryptionKeys, setDecryptionKeys] = useState()\n  const [loadingConversations, setLoadingConversations] = useState(false)\n  const [loadingMessages, setLoadingMessages] = useState(false)\n  const [encryptMessages, setEncryptMessages] = useState(false)\n  const [sendFile, setSendFile] = useState(null)\n  const [sendingFile, setSendingFile] = useState(false)\n  const [isVisible, setIsVisible] = useState(false)\n  const { user } = useContext(AuthContext)\n  const width = useWindowSize()\n  const { onlineUsers, arrivalMessage, newConversation, dispatch } =\n    useContext(SocketContext)\n  const scrollRef = useRef()\n\n  const friendId = useLocation().search?.split('=')[1]\n\n  useEffect(() => {\n    arrivalMessage &&\n      currentChat?.members.includes(arrivalMessage.sender) &&\n      setMessages((prev) => [...prev, arrivalMessage])\n  }, [arrivalMessage, currentChat])\n\n  useEffect(() => {\n    if (newConversation) {\n      const { conversation } = newConversation\n      setConversations((prev) => [...prev, conversation])\n      setAllConversations((prev) => [...prev, conversation])\n    }\n  }, [newConversation])\n\n  useEffect(() => {\n    setLoadingConversations(true)\n    getConversations(user._id)\n      .then((res) => {\n        setAllConversations(res.data)\n        setConversations(res.data)\n        setLoadingConversations(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingConversations(false)\n        message.error('Something went wrong!')\n      })\n  }, [user._id])\n\n  useEffect(() => {\n    setLoadingMessages(true)\n    if (currentChat) {\n      getUserById(currentChat?.members?.find((el) => el !== user._id))\n        .then((res) => {\n          setFriend(res.data)\n        })\n        .catch((err) => console.log(err))\n    }\n    getMessages(currentChat?._id)\n      .then((res) => {\n        if (res.data && res.data.length > 0)\n          setMessages(\n            res.data.sort(\n              (a, b) => new Date(a.createdAt) - new Date(b.createdAt)\n            )\n          )\n        dispatch(setArrivalMessage(null))\n        setLoadingMessages(false)\n      })\n      .catch((err) => {\n        console.log(err)\n        setLoadingMessages(false)\n        message.error('Something went wrong!')\n      })\n  }, [currentChat, user, dispatch])\n\n  useEffect(() => {\n    DeriveKeys(friend?.publicKeyJwk, user?.privateKeyJwk).then((res) => {\n      setDecryptionKeys(res)\n    })\n  }, [friend, user])\n\n  const sendMessageHandler = async (e, url) => {\n    e?.preventDefault()\n    const encryptedMessages = await Encrypt(url ?? newMessage, decryptionKeys)\n    if (url || newMessage) {\n      sendNewMessage({\n        conversationId: currentChat._id,\n        sender: user._id,\n        text: encryptedMessages,\n      })\n        .then((res) => {\n          setNewMessage('')\n          setSendingFile(false)\n          setMessages([...messages, res.data])\n\n          const receiverId = currentChat.members?.find((el) => el !== user._id)\n          socket.current.emit('sendMessage', {\n            senderId: user._id,\n            receiverId,\n            text: encryptedMessages,\n          })\n        })\n        .catch((err) => {\n          console.log(err)\n          message.error('Something went wrong!')\n        })\n    }\n  }\n\n  useEffect(() => {\n    scrollRef.current?.scrollIntoView({ behavior: 'smooth' })\n  }, [messages, encryptMessages])\n\n  const handleChange = (event) => {\n    setLoadingConversations(true)\n    const { value } = event.target\n    if (value === '') setConversations(AllConversations)\n    else {\n      const filteredConversations = AllConversations.filter((con) => {\n        if (\n          con?.member?.username\n            .toLocaleLowerCase()\n            .includes(value.toLocaleLowerCase())\n        )\n          return con\n        return 0\n      })\n      setConversations(filteredConversations)\n    }\n    setLoadingConversations(false)\n  }\n\n  const updateConversations = (data) => {\n    socket.current.emit('addConversation', data)\n  }\n\n  useEffect(() => {\n    if (friendId) {\n      getConversationByOfTwoUsers(user._id, friendId)\n        .then((res) => {\n          if (res.data.new)\n            updateConversations({\n              senderId: user._id,\n              receiverId: friendId,\n              conversation: res.data.data,\n            })\n          setCurrentChat(res.data.data)\n        })\n        .catch((err) => {\n          console.log(err)\n        })\n    }\n    // eslint-disable-next-line\n  }, [friendId, user])\n\n  const closeModal = () => {\n    setIsVisible(false)\n    setSendFile(null)\n  }\n\n  const fileChangeHandler = (file) => {\n    if (file.file?.originFileObj) {\n      setSendFile(file.file?.originFileObj)\n      setIsVisible(true)\n      setSendingFile(true)\n    }\n  }\n\n  const fileTypeCheckHandler = (file) => {\n    const acceptedFileType = ['image/png', 'image/jpeg', 'image/jpg']\n    if (!acceptedFileType.includes(file.type)) {\n      message.error(`${file.name} is not an image file!`)\n      return false\n    }\n    return true\n  }\n\n  const sendImageHandler = () => {\n    upload(sendFile, (err, response) => {\n      if (!err) {\n        sendMessageHandler(null, response)\n        closeModal()\n      } else {\n        message.error(err?.message || 'Please try again later.')\n      }\n    })\n  }\n\n  return (\n    <>\n      <Topbar />\n      <div className={`messenger ${width < 783 ? 'messengerMobile' : ''}`}>\n        <div\n          className={`chatMenu ${\n            width < 783 && !currentChat ? 'chatMenuMobile' : ''\n          }`}\n        >\n          <div className='chatMenuWrapper'>\n            <h5 className='sectionTitle'>Your recent conversations</h5>\n            <input\n              type='text'\n              placeholder='Search for friends'\n              className='chatMenuInput'\n              onChange={handleChange}\n            />\n            {!loadingConversations ? (\n              conversations.length > 0 ? (\n                conversations.map((el, i) => (\n                  <div key={i} onClick={() => setCurrentChat(el)}>\n                    <Conversation\n                      AllConversations={AllConversations}\n                      setAllConversations={setAllConversations}\n                      conversation={el}\n                      currentUser={user}\n                    />\n                  </div>\n                ))\n              ) : (\n                <span className='noChatText'>\n                  You don't have any conversations yet.\n                </span>\n              )\n            ) : (\n              [...Array(3).keys()].map((el, i) => (\n                <div\n                  key={i}\n                  className='d-flex align-items-center ps-2 pe-3 py-2'\n                >\n                  <div>\n                    <Skeleton circle width={40} height={40} />\n                  </div>\n                  <div className='w-100 ps-3'>\n                    <Skeleton count={3} />\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n        <div\n          className={`chatBox ${\n            width < 783 && currentChat ? 'chatBoxMobile' : ''\n          }`}\n        >\n          <div className='chatBoxWrapper'>\n            {currentChat && (\n              <div className='chatBoxHeader d-flex justify-content-between align-items-center'>\n                <IconButton onClick={() => setCurrentChat(null)}>\n                  <KeyboardBackspaceIcon\n                    style={{ color: '#5e5e5e', fontSize: 28 }}\n                  />\n                </IconButton>\n                <Tooltip\n                  overlayStyle={{ whiteSpace: 'pre-line', fontSize: 13 }}\n                  title={`Enable this if you want to see the encrypt message`}\n                  placement='bottom'\n                >\n                  <Switch onChange={(checked) => setEncryptMessages(checked)} />\n                </Tooltip>\n              </div>\n            )}\n            {currentChat ? (\n              <>\n                <div className='chatBoxTop'>\n                  {loadingMessages &&\n                    [...Array(6).keys()].map((el, i) => (\n                      <div\n                        key={i}\n                        className={`d-flex align-items-center ps-2 pe-3 py-2 w-50 ${\n                          i % 2 === 0 ? 'ms-auto' : ''\n                        }`}\n                      >\n                        <div>\n                          <Skeleton circle width={40} height={40} />\n                        </div>\n                        <div className='w-100 ps-3'>\n                          <Skeleton count={3} />\n                        </div>\n                      </div>\n                    ))}\n                  {messages.length > 0 ? (\n                    messages.map((el, i) => (\n                      <div key={i} ref={scrollRef}>\n                        <Message\n                          encryptMessages={encryptMessages}\n                          derivedKeys={decryptionKeys}\n                          Decrypt={Decrypt}\n                          message={el}\n                          setSendFile={setSendFile}\n                          setIsVisible={setIsVisible}\n                          friend={friend}\n                          own={el.sender === user._id}\n                        />\n                      </div>\n                    ))\n                  ) : (\n                    <span className='noConversationText'>\n                      {!loadingMessages &&\n                        `Write your first message to ${friend?.username}...`}\n                    </span>\n                  )}\n                </div>\n                <div className='chatBoxBottom'>\n                  <textarea\n                    className='chatMessageInput'\n                    placeholder='Write something...'\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    value={newMessage}\n                    rows={1}\n                  ></textarea>\n\n                  <Upload\n                    accept='image/*'\n                    name='file'\n                    onChange={fileChangeHandler}\n                    beforeUpload={fileTypeCheckHandler}\n                  >\n                    <button className='chatFileAttachBtn'>\n                      <AttachFileIcon />\n                    </button>\n                  </Upload>\n\n                  <button\n                    className='chatSubmitBtn'\n                    onClick={sendMessageHandler}\n                  >\n                    <SendIcon style={{ color: '#fff' }} />\n                  </button>\n                </div>\n              </>\n            ) : (\n              <span className='noConversationText'>\n                Open a conversation to start a chat.\n              </span>\n            )}\n          </div>\n        </div>\n        <div className='chatOnline'>\n          <div className='chatOnlineWrapper'>\n            <h5 className='sectionTitle'>Your friends</h5>\n            <ChatOnline\n              onlineUsers={onlineUsers}\n              currentId={user._id}\n              setCurrentChat={setCurrentChat}\n              updateConversations={updateConversations}\n            />\n          </div>\n        </div>\n      </div>\n      <Modal\n        visible={isVisible}\n        onCancel={closeModal}\n        footer={null}\n        width={450}\n        className='imageModal'\n      >\n        <div className='modalImageContainer'>\n          {sendFile && (\n            <img\n              src={\n                typeof sendFile === 'object'\n                  ? URL.createObjectURL(sendFile)\n                  : sendFile\n              }\n              alt=''\n            />\n          )}\n        </div>\n        {sendingFile && (\n          <button\n            className='chatSubmitBtn imgSendBtn'\n            onClick={sendImageHandler}\n          >\n            <SendIcon style={{ color: '#fff' }} />\n          </button>\n        )}\n      </Modal>\n    </>\n  )\n}\n\nexport default Messenger\n","import React from 'react'\nimport './floating.css'\nimport Fab from '@material-ui/core/Fab'\nimport MessageIcon from '@material-ui/icons/Message'\nimport { useHistory } from 'react-router'\nimport useWindowSize from '../../utils/windowSize'\n\nconst Floating = () => {\n  const history = useHistory()\n  const width = useWindowSize()\n  return history.location.pathname === '/messenger' && width < 783 ? null : (\n    <Fab\n      color='primary'\n      aria-label='add'\n      className='message-ctaBtn'\n      onClick={() => history.push('/messenger')}\n    >\n      <MessageIcon />\n    </Fab>\n  )\n}\n\nexport default Floating\n","import Home from './pages/home/Home'\nimport Login from './pages/login/Login'\nimport Profile from './pages/profile/Profile'\nimport Register from './pages/register/Register'\nimport Messenger from './pages/messenger/Messenger'\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom'\nimport { useContext, useEffect } from 'react'\nimport useSocket from './utils/socket'\nimport { AuthContext } from './context/Auth'\nimport { SocketContext } from './context/Socket'\nimport { ThemeContext } from './context/Theme'\nimport { setOnlineUsers } from './context/Socket/SocketActions'\nimport Floating from './components/floatingMessage/Floating'\nimport { Notifications } from 'react-push-notification'\n\nfunction App() {\n  const { user } = useContext(AuthContext)\n  const { dispatch } = useContext(SocketContext)\n  const { theme } = useContext(ThemeContext)\n  const { socket } = useSocket()\n\n  useEffect(() => {\n    if (theme === 'dark') {\n      document.body.classList.add('darkTheme')\n      document.body.classList.remove('lightTheme')\n    } else {\n      document.body.classList.remove('darkTheme')\n      document.body.classList.add('lightTheme')\n    }\n  }, [theme])\n\n  useEffect(() => {\n    if (socket && socket.current) {\n      socket.current.on('getUsers', (users) => {\n        console.log({ users })\n        dispatch(\n          setOnlineUsers(\n            user?.followings.filter((el) => users.some((u) => u.userId === el))\n          )\n        )\n      })\n    }\n  }, [user, dispatch, socket])\n\n  return (\n    <Router>\n      <Notifications />\n      <Switch>\n        <Route exact path='/'>\n          {user ? <Home /> : <Register />}\n        </Route>\n        <Route path='/login'>{user ? <Redirect to='/' /> : <Login />}</Route>\n        <Route path='/register'>\n          {user ? <Redirect to='/' /> : <Register />}\n        </Route>\n        <Route path='/messenger'>\n          {!user ? <Redirect to='/' /> : <Messenger />}\n        </Route>\n        <Route path='/profile/:username'>\n          {!user ? <Redirect to='/' /> : <Profile />}\n        </Route>\n      </Switch>\n      {user && <Floating />}\n    </Router>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { AuthContextProvider } from './context/Auth'\nimport { SocketProvider } from './context/Socket'\nimport { ThemeContextProvider } from './context/Theme'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport 'antd/dist/antd.css'\nimport 'react-loading-skeleton/dist/skeleton.css'\nimport './style.scss'\n\nReactDOM.render(\n  <React.StrictMode>\n    <AuthContextProvider>\n      <SocketProvider>\n        <ThemeContextProvider>\n          <App />\n        </ThemeContextProvider>\n      </SocketProvider>\n    </AuthContextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}