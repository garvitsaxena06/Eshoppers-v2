(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{196:function(e,t){},301:function(e,t,n){},321:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},400:function(e,t,n){},811:function(e,t,n){},812:function(e,t,n){},813:function(e,t,n){},814:function(e,t,n){},815:function(e,t,n){},816:function(e,t,n){},817:function(e,t,n){},818:function(e,t,n){},819:function(e,t,n){},820:function(e,t,n){},821:function(e,t,n){},825:function(e,t,n){},826:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(20),s=n.n(a),i=n(8),o=n(39),l=n(3),u=(n(301),n(859)),j=n(865),d=n(867),b=n(868),h=n(869),p=n(870),f=n(271),O=n.n(f),m=n(884),x=n(883),v=n(864),g=n(862),N=n(27),w=n(67),y=n(282),C=n(885),k=n(284),I=n(890),S=n(887),_=n(888),L=n(866),E=n(30),P=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:!0};case"FOLLOW":return Object(l.a)(Object(l.a)({},e),{},{user:Object(l.a)(Object(l.a)({},e.user),{},{followings:[].concat(Object(o.a)(e.user.followings),[t.payload])})});case"UNFOLLOW":return Object(l.a)(Object(l.a)({},e),{},{user:Object(l.a)(Object(l.a)({},e.user),{},{followings:e.user.followings.filter((function(e){return e!==t.payload}))})});case"UPDATE":return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case"LOGOUT":return{user:null,isFetching:!1,error:!1};default:return e}},A=n(1),T={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},U=Object(c.createContext)(T),F=function(e){var t=e.children,n=Object(c.useReducer)(P,T),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){localStorage.setItem("user",JSON.stringify(a.user))}),[a.user]),Object(A.jsx)(U.Provider,{value:{user:a.user,isFetching:a.isFetching,error:a.error,dispatch:s},children:t})},R=function(e,t){switch(t.type){case"CHANGE_THEME":return{theme:t.payload};default:return e}},D={theme:localStorage.getItem("theme")||"light"},B=Object(c.createContext)(D),M=function(e){var t=e.children,n=Object(c.useReducer)(R,D),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(A.jsx)(B.Provider,{value:{theme:a.theme,dispatch:s},children:t})},K=function(e){return{type:"CHANGE_THEME",payload:e}},W=n(12),H=n.n(W),z=n(23),G=n(35),V=n.n(G),q="https://k5gxjlwjl0.execute-api.ap-south-1.amazonaws.com/posts",J="https://2r0sg4bxg5.execute-api.ap-south-1.amazonaws.com/users",Y="https://95rv9rmrxi.execute-api.ap-south-1.amazonaws.com/conversations",X="https://5kq2t3b9fi.execute-api.ap-south-1.amazonaws.com/messages",Q=function(){var e=Object(z.a)(H.a.mark((function e(t,n){var c,r,a;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"LOGIN_START"}),e.prev=1,e.next=4,V.a.post("".concat(J,"/login"),t);case 4:c=e.sent,n({type:"LOGIN_SUCCESS",payload:c.data}),y.b.success("Logged in successfully."),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),n({type:"LOGIN_FAILURE",payload:e.t0}),y.b.error(null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(z.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("".concat(J,"/register"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(J,"?userId=")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(J,"?username=")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(J,"/friends/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(J,"/friendsByUserName/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(z.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("".concat(J,"/").concat(t,"/unfollow"),{userId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=Object(z.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("".concat(J,"/").concat(t,"/follow"),{userId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ae=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("".concat(J,"/").concat(t.userId),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(Y,"/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(X,"/")+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("".concat(X),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(z.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(Y,"/find/").concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ue=function(){var e=Object(z.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("".concat(J,"/search?q=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(z.a)(H.a.mark((function e(t){var n,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,c=t.payload,e.next=3,V.a.put("".concat(q,"/").concat(n,"/like"),c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(z.a)(H.a.mark((function e(t){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,t.userId,e.next=3,V.a.delete("".concat(q,"/").concat(n));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=Object(c.useState)(0),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(c.useLayoutEffect)((function(){var e=function(){r(window.innerWidth)};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[]),n},he=function(e,t){switch(t.type){case"SET_ONLINE_USERS":return Object(l.a)(Object(l.a)({},e),{},{onlineUsers:t.payload});case"SET_ARRIVAL_MESSAGE":return Object(l.a)(Object(l.a)({},e),{},{arrivalMessage:t.payload});case"SET_NEW_CONVERSATION":return Object(l.a)(Object(l.a)({},e),{},{newConversation:t.payload});default:return e}},pe={onlineUsers:[],arrivalMessage:null,newConversation:null},fe=Object(c.createContext)(pe),Oe=function(e){var t=e.children,n=Object(c.useReducer)(he,pe),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(A.jsx)(fe.Provider,{value:{onlineUsers:a.onlineUsers,arrivalMessage:a.arrivalMessage,newConversation:a.newConversation,dispatch:s},children:t})};n(321);function me(e){var t=e.user,n=e.online,c=void 0===n||n;return Object(A.jsxs)("li",{className:"rightbarFriend",children:[Object(A.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(A.jsx)("img",{className:"rightbarProfileImg",src:""!==t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(A.jsx)("span",{className:c?"rightbarOnline":"rightbarOffline"})]}),Object(A.jsx)("span",{className:"rightbarUsername",children:t.username})]})}var xe=n(280),ve=function(){var e=Object(c.useContext)(U).user,t=Object(c.useContext)(fe).dispatch,n=Object(c.useRef)();return Object(c.useEffect)((function(){e&&(n.current=Object(xe.a)("https://viachat.docplus.online",{path:"/socket/socket.io"}),n.current.emit("addUser",null===e||void 0===e?void 0:e._id),n.current.on("getMessage",(function(e){var n=e.senderId,c=e.text;t({type:"SET_ARRIVAL_MESSAGE",payload:{sender:n,text:c,createdAt:Date.now()}})})),n.current.on("getConversation",(function(e){var n=e.senderId,c=e.conversation;t(function(e){return{type:"SET_NEW_CONVERSATION",payload:e}}({senderId:n,conversation:c}))})))}),[e,t]),{socket:n}};function ge(){var e=Object(c.useContext)(U),t=e.user,n=e.dispatch,r=Object(c.useContext)(fe).onlineUsers,a=ve().socket,s=Object(c.useContext)(B),f=s.theme,P=s.dispatch,T=Object(N.g)(),F=Object(c.useState)([]),R=Object(i.a)(F,2),D=R[0],M=R[1],W=Object(c.useState)(!1),H=Object(i.a)(W,2),z=H[0],G=H[1],V=Object(c.useState)([]),q=Object(i.a)(V,2),J=q[0],Y=q[1],X=Object(c.useState)([]),Q=Object(i.a)(X,2),Z=Q[0],$=Q[1],ee=Object(c.useState)(!0),ne=Object(i.a)(ee,2),ce=ne[0],re=ne[1],ae=be();Object(c.useEffect)((function(){re(!0),te(t._id).then((function(e){Y(e.data),re(!1)})).catch((function(e){console.log(e),re(!1)}))}),[t._id]),Object(c.useEffect)((function(){$(J.filter((function(e){return null===r||void 0===r?void 0:r.includes(e._id)})))}),[r,J]);var se=function(){G(!1)},ie=function(){localStorage.removeItem("user"),n({type:"LOGOUT"}),a.current.emit("logoutUser",t._id),y.b.success("Logout successfully."),T.push("/")},oe=Object(A.jsxs)(C.a,{children:[Object(A.jsx)(C.a.Item,{children:Object(A.jsx)(w.b,{to:"/profile/".concat(t.username),children:"Profile"})},"Profile"),Object(A.jsx)(C.a.Item,{children:Object(A.jsx)("div",{onClick:ie,children:"Logout"})},"Logout")]});return Object(A.jsxs)("div",{className:"topbarContainer",children:[Object(A.jsx)("div",{className:"topbarLeft",children:Object(A.jsx)(w.b,{to:"/",style:{textDecoration:"none"},children:Object(A.jsx)("span",{className:"logo",children:"Lamasocial"})})}),Object(A.jsx)("div",{className:"topbarCenter",children:Object(A.jsxs)("div",{className:"searchbar",children:[Object(A.jsx)(u.a,{className:"searchIcon"}),Object(A.jsx)(m.a,{freeSolo:!0,id:"free-solo-2-demo",options:D,PaperComponent:function(e){var t=e.children;return Object(A.jsx)(g.a,{style:"dark"===f?{background:"#0a0c0e",border:"1px solid #181111"}:{},children:t})},getOptionLabel:function(e){return e.username},renderOption:function(e){return Object(A.jsxs)("div",{className:"searchSuggestions",onClick:function(){return T.push("/profile/".concat(e.username))},children:[Object(A.jsx)("div",{className:"profilePicture",children:Object(A.jsx)("img",{src:e.profilePicture?e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"topbarImg"})}),Object(A.jsxs)("div",{className:"searchContent",children:[Object(A.jsx)("div",{className:"email",children:e.email}),Object(A.jsx)("div",{className:"username",children:e.username})]})]})},renderInput:function(e){return Object(A.jsx)(x.a,Object(l.a)(Object(l.a)({},e),{},{label:ae>340?"Search for friend (by username)":"Search for friend",margin:"normal",onChange:function(e){return function(e){var t=e.target.value;t?ue(t).then((function(e){M(e.data)})).catch((function(e){console.log(e),M([])})):M([])}(e)},InputProps:Object(l.a)(Object(l.a)({},e.InputProps),{},{type:"search"})}))}})]})}),Object(A.jsxs)("div",{className:"topbarRight",children:[Object(A.jsxs)("div",{className:"topbarLinks",children:[Object(A.jsx)("span",{className:"topbarLink",onClick:function(){return T.push("/")},children:"Homepage"}),Object(A.jsx)("span",{className:"topbarLink",onClick:function(){return T.push("/profile/".concat(t.username))},children:"Timeline"})]}),Object(A.jsxs)("div",{className:"d-flex align-items-center",children:[Object(A.jsxs)("div",{className:"topbarIcons",children:[Object(A.jsx)("div",{className:"topbarIconItem",onClick:function(){return T.push("/messenger")},children:Object(A.jsx)(j.a,{})}),Object(A.jsx)("div",{className:"topbarIconItem",children:Object(A.jsx)(k.a,{overlayStyle:{whiteSpace:"pre-line",fontSize:13},title:"Dark theme",placement:"bottom",children:Object(A.jsx)(I.a,{size:"small",checked:"dark"===f,onChange:function(e){P(K(e?"dark":"light")),localStorage.setItem("theme",e?"dark":"light")}})})})]}),Object(A.jsxs)("span",{className:"helloUserText",children:["Hello, ",null===t||void 0===t?void 0:t.username]}),Object(A.jsx)(S.a,{overlay:oe,children:Object(A.jsx)("img",{src:t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"topbarImg"})})]})]}),Object(A.jsx)("div",{className:"menuIcon",children:Object(A.jsx)(v.a,{onClick:function(){G(!0)},children:Object(A.jsx)(O.a,{style:{color:"#fff"}})})}),Object(A.jsxs)(_.a,{width:ae>370?320:"100%",placement:"right",visible:z,onClose:se,children:[Object(A.jsxs)("div",{className:"profileContainer",children:[Object(A.jsx)("img",{src:t.profilePicture?t.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",style:{width:80,height:80},alt:"",className:"topbarImg"}),Object(A.jsxs)("div",{className:"profileContent ms-2",children:[Object(A.jsxs)("h5",{className:"profileUsername",children:["Hello, ",Object(A.jsx)("br",{})," ",Object(A.jsxs)("strong",{children:["@",t.username]})]}),Object(A.jsx)(w.b,{to:"/profile/".concat(t.username),children:"Visit your profile"})]})]}),Object(A.jsx)(L.a,{}),Object(A.jsxs)("div",{className:"profileLinks",children:[Object(A.jsxs)("div",{className:"profileLink",children:[Object(A.jsx)(d.a,{}),Object(A.jsx)("span",{onClick:function(){return T.push("/")},children:"Homepage"})]}),Object(A.jsxs)("div",{className:"profileLink",children:[Object(A.jsx)(b.a,{}),Object(A.jsx)("span",{onClick:function(){return T.push("/profile/".concat(t.username))},children:"Timeline"})]}),Object(A.jsxs)("div",{className:"profileLink",children:[Object(A.jsx)(h.a,{}),Object(A.jsx)("span",{onClick:function(){return T.push("/messenger")},children:"Messenger"})]}),Object(A.jsxs)("div",{className:"profileLink",children:[Object(A.jsx)(p.a,{}),Object(A.jsx)("span",{onClick:ie,children:"Logout"})]}),Object(A.jsx)(L.a,{}),Object(A.jsxs)("div",{className:"profileLink mt-2",children:[Object(A.jsx)(I.a,{checked:"dark"===f,onChange:function(e){P(K(e?"dark":"light")),localStorage.setItem("theme",e?"dark":"light")}}),"Toggle theme"]})]}),Object(A.jsx)(L.a,{}),Object(A.jsx)("h5",{className:"profileUsername mb-3",children:"Your friends"}),ce?Object(o.a)(Array(2).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})):J.map((function(e){var t,n=(t=e._id,Z.some((function(e){return e._id===t})));return Object(A.jsx)("div",{onClick:function(){se(),T.push("/messenger?q=".concat(e._id))},style:{cursor:"pointer"},children:Object(A.jsx)(me,{user:e,online:n},e._id)},e._id)}))]})]})}n(397);var Ne=n(871);n(398);function we(e){var t=e.user,n=Object(N.g)();return Object(A.jsxs)("li",{className:"sidebarFriend",onClick:function(){return n.push("/profile/"+t.username)},children:[Object(A.jsx)("img",{className:"sidebarFriendImg",src:""!==t.profilePicture?t.profilePicture.replace("s3.ap-south-1.amazonaws.com/social-app-assets","d225jocw4xhwve.cloudfront.net"):"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(A.jsx)("span",{className:"sidebarFriendName",children:t.username})]})}function ye(){var e=Object(c.useContext)(U).user,t=Object(N.g)(),n=Object(c.useState)([]),r=Object(i.a)(n,2),a=r[0],s=r[1],l=Object(c.useState)(!0),u=Object(i.a)(l,2),d=u[0],b=u[1];return Object(c.useEffect)((function(){b(!0),te(e._id).then((function(e){s(e.data),b(!1)})).catch((function(e){console.log(e),b(!1)}))}),[e]),Object(A.jsx)("div",{className:"sidebar",children:Object(A.jsxs)("div",{className:"sidebarWrapper",children:[Object(A.jsxs)("ul",{className:"sidebarList",children:[Object(A.jsxs)("li",{className:"sidebarListItem",onClick:function(){return t.push("/profile/".concat(e.username))},children:[Object(A.jsx)(Ne.a,{className:"sidebarIcon"}),Object(A.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(A.jsxs)("li",{className:"sidebarListItem",onClick:function(){return t.push("/messenger")},children:[Object(A.jsx)(j.a,{className:"sidebarIcon"}),Object(A.jsx)("span",{className:"sidebarListItemText",children:"Chats"})]})]}),Object(A.jsx)("hr",{className:"sidebarHr"}),Object(A.jsx)("ul",{className:"sidebarFriendList",children:d?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})):a.map((function(e){return Object(A.jsx)(we,{user:e},e._id)}))})]})})}n(399);var Ce=n(872),ke=n(174);function Ie(e){var t=e.post,n=e.fetchPosts,r=Object(c.useState)(t.likes.length),a=Object(i.a)(r,2),s=a[0],o=a[1],l=Object(c.useState)(!1),u=Object(i.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)({}),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(c.useContext)(U).user,m=Object(N.g)();Object(c.useEffect)((function(){d(t.likes.includes(O._id))}),[O._id,t.likes]),Object(c.useEffect)((function(){(function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$(t.userId).then((function(e){f(e.data)})).catch((function(e){return console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.userId]);var x=function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de({_id:t._id}).then((function(e){y.b.success("Post deleted successfully."),n()})).catch((function(e){y.b.error("Something went wrong!")}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=Object(A.jsx)(C.a,{children:Object(A.jsx)(C.a.Item,{children:Object(A.jsx)("span",{onClick:x,children:"Delete"})})});return Object(A.jsx)("div",{className:"post",children:Object(A.jsxs)("div",{className:"postWrapper",children:[Object(A.jsxs)("div",{className:"postTop",children:[Object(A.jsxs)("div",{className:"postTopLeft",children:[Object(A.jsx)(w.b,{to:"/profile/".concat(p.username),children:Object(A.jsx)("img",{className:"postProfileImg",src:p.profilePicture?p.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""})}),Object(A.jsx)("span",{className:"postUsername",onClick:function(){return m.push("/profile/".concat(p.username))},children:p.username}),Object(A.jsx)("span",{className:"postDate",children:Object(ke.a)(t.createdAt)})]}),(null===t||void 0===t?void 0:t.userId)===(null===O||void 0===O?void 0:O._id)&&Object(A.jsx)("div",{className:"postTopRight",style:{cursor:"pointer"},children:Object(A.jsx)(S.a,{overlay:v,children:Object(A.jsx)(Ce.a,{})})})]}),Object(A.jsxs)("div",{className:"postCenter",children:[Object(A.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),t.img&&Object(A.jsx)("img",{className:"postImg",src:t.img,alt:""})]}),Object(A.jsx)("div",{className:"postBottom",children:Object(A.jsxs)("div",{className:"postBottomLeft",children:[Object(A.jsx)("img",{className:"likeIcon",src:"".concat("https://d225jocw4xhwve.cloudfront.net/","like.png"),onClick:function(){try{je({_id:t._id,payload:{userId:O._id}})}catch(e){}o(j?s-1:s+1),d(!j)},alt:""}),Object(A.jsxs)("span",{className:"postLikeCounter",children:[s," people like it"]})]})})]})})}n(400);var Se=n(873),_e=n(874),Le=n(401);Le.config={secretAccessKey:"aHOzpUp3nCoHyYL3rGRsejyjNPC94psK1nvUcgat",accessKeyId:"AKIA3JPVUL47F5NR5XMG",region:"ap-south-1"};var Ee=new Le.S3,Pe="social-app-assets",Ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};try{var n="".concat(null===e||void 0===e?void 0:e.name,"-").concat((new Date).getTime()),c={Bucket:Pe,Key:n,Expires:9e4,ContentType:e.type,ACL:"public-read"};Ee.getSignedUrl("putObject",c,(function(c,r){if(c)return t(c);var a={headers:{"Content-Type":e.type}},s="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUBLIC_FOLDER:"https://d225jocw4xhwve.cloudfront.net/"}).CLOUDFRONT_ASSETS_URL||"https://d225jocw4xhwve.cloudfront.net","/").concat(n);V.a.put(r,e,a).then((function(){return t(!1,s)})).catch((function(e){return t(e)}))}))}catch(r){console.log({err:r})}};function Te(e){var t=e.fetchPosts,n=Object(c.useContext)(U).user,r=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useState)(null),o=Object(i.a)(s,2),l=o[0],u=o[1],j=function(e){V.a.post(q,e).then((function(e){y.b.success("New Post Uploaded"),t()})).catch((function(e){y.b.error((null===e||void 0===e?void 0:e.data)||"Please try again later.")}))},d=function(){var e=Object(z.a)(H.a.mark((function e(t){var c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={userId:n._id,desc:r.current.value},l)try{Ae(l,(function(e,t){e?y.b.error((null===e||void 0===e?void 0:e.message)||"Please try again later."):(c.img=t,j(c))}))}catch(a){}else j(c);r.current.value="",u(null);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(A.jsx)("div",{className:"share",children:Object(A.jsxs)("div",{className:"shareWrapper",children:[Object(A.jsxs)("div",{className:"shareTop",children:[Object(A.jsx)("img",{className:"shareProfileImg",src:n.profilePicture?n.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),Object(A.jsx)("textarea",{placeholder:"What's in your mind "+n.username+"?",className:"shareInput",ref:r})]}),Object(A.jsx)("hr",{className:"shareHr"}),l&&Object(A.jsxs)("div",{className:"shareImgContainer",children:[Object(A.jsx)("img",{className:"shareImg",src:URL.createObjectURL(l),alt:""}),Object(A.jsx)(Se.a,{className:"shareCancelImg",onClick:function(){u(null),a.current.value=null}})]}),Object(A.jsxs)("form",{className:"shareBottom",onSubmit:d,children:[Object(A.jsx)("div",{className:"shareOptions",children:Object(A.jsxs)("label",{htmlFor:"feedPost",className:"shareOption",children:[Object(A.jsx)(_e.a,{htmlColor:"tomato",className:"shareIcon"}),Object(A.jsx)("span",{className:"shareOptionText",children:"Photo or Video"}),Object(A.jsx)("input",{style:{display:"none"},type:"file",ref:a,id:"feedPost",accept:".png,.jpeg,.jpg",onChange:function(e){return u(e.target.files[0])}})]})}),Object(A.jsx)("button",{className:"shareButton",type:"submit",children:"Share"})]})]})})}n(811);function Ue(e){var t=e.username,n=e.user,r=Object(c.useState)([]),a=Object(i.a)(r,2),s=a[0],l=a[1],u=Object(c.useState)(!0),j=Object(i.a)(u,2),d=j[0],b=j[1],h=Object(c.useContext)(U).user,p=function(){var e=Object(z.a)(H.a.mark((function e(){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b(!0),e.prev=1,!t){e.next=8;break}return e.next=5,V.a.get("".concat(q,"/profile/")+t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,V.a.get("".concat(q,"/timeline/")+h._id);case 10:e.t0=e.sent;case 11:n=e.t0,l(n.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}))),b(!1),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),b(!1);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){p()}),[t,h._id,n]),Object(A.jsx)("div",{className:"feed",children:Object(A.jsxs)("div",{className:"feedWrapper",children:[(!t||t===h.username)&&Object(A.jsx)(Te,{fetchPosts:p}),d?Object(o.a)(Array(2).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"mt-3",children:[Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"ps-3",children:Object(A.jsx)(E.a,{count:2,width:200})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{width:100})})]}),Object(A.jsx)(E.a,{count:2}),Object(A.jsx)(E.a,{height:180}),Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"ps-3",children:Object(A.jsx)(E.a,{width:200})})]})]},t)})):s.map((function(e){return Object(A.jsx)(Ie,{fetchPosts:p,post:e},e._id)}))]})})}n(812);var Fe=n(875),Re=n(876),De=n(877),Be=n(42),Me=n(882),Ke=n(886),We=n(276),He=n(891);function ze(e){var t=e.show,n=e.handleClose,r=e.handleSubmit,a=e.user,s=Object(c.useState)(!1),o=Object(i.a)(s,2),u=o[0],j=o[1],d=Object(c.useState)({firstName:"",lastName:"",city:""}),b=Object(i.a)(d,2),h=b[0],p=b[1];Object(c.useEffect)((function(){a&&p((function(e){return Object(l.a)(Object(l.a)({},e),a)}))}),[a]);return Object(A.jsxs)(Me.a,{show:t,onHide:n,children:[Object(A.jsx)(Me.a.Header,{closeButton:!0,children:Object(A.jsx)(Me.a.Title,{children:"User information"})}),Object(A.jsx)(Me.a.Body,{children:Object(A.jsxs)(Ke.a,{noValidate:!0,validated:u,onSubmit:function(e){var t=e.currentTarget;e.preventDefault(),!1===t.checkValidity()&&e.stopPropagation(),j(!0),r(h)},children:[Object(A.jsxs)(Ke.a.Group,{as:We.a,className:"mb-3",controlId:"firstName",children:[Object(A.jsx)(Ke.a.Label,{children:"First name"}),Object(A.jsx)(Ke.a.Control,{required:!0,type:"text",minLength:5,placeholder:"First name",name:"firstName",value:h.firstName,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(A.jsx)(Ke.a.Control.Feedback,{children:"Looks good!"}),Object(A.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid First name."})]}),Object(A.jsxs)(Ke.a.Group,{as:We.a,className:"mb-3",controlId:"lastName",children:[Object(A.jsx)(Ke.a.Label,{children:"Last name"}),Object(A.jsx)(Ke.a.Control,{required:!0,type:"text",minLength:5,placeholder:"Last name",name:"lastName",value:h.lastName,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(A.jsx)(Ke.a.Control.Feedback,{children:"Looks good!"}),Object(A.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid First name."})]}),Object(A.jsxs)(Ke.a.Group,{as:We.a,className:"mb-3",controlId:"city",children:[Object(A.jsx)(Ke.a.Label,{children:"City"}),Object(A.jsx)(Ke.a.Control,{name:"city",type:"text",placeholder:"City",required:!0,value:h.city,onChange:function(e){return p(Object(l.a)(Object(l.a)({},h),{},Object(Be.a)({},e.target.name,e.target.value)))}}),Object(A.jsx)(Ke.a.Control.Feedback,{type:"invalid",children:"Please provide a valid city."})]}),Object(A.jsxs)("div",{className:"d-flex",children:[Object(A.jsx)(He.a,{variant:"secondary",onClick:n,children:"Close"}),Object(A.jsx)(He.a,{variant:"primary",style:{marginLeft:"12px"},onClick:r,type:"submit",children:"Save Changes"})]})]})})]})}function Ge(e){var t=e.user,n=e.onlineFriends,r=e.UpdateUserDetails,a=void 0===r?function(){}:r,s=e.loadingFriends,l=e.loadingUserDetails,u=void 0!==l&&l,d=e.mobileView,b=Object(c.useState)([]),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(N.g)(),m=Object(c.useContext)(U),x=m.user,v=m.dispatch,g=Object(c.useState)(x.followings.includes(null===t||void 0===t?void 0:t._id)),C=Object(i.a)(g,2),k=C[0],I=C[1];Object(c.useEffect)((function(){I(x.followings.includes(null===t||void 0===t?void 0:t._id))}),[x,t]),Object(c.useEffect)((function(){(function(){var e=Object(z.a)(H.a.mark((function e(){var n,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.username){e.next=13;break}return e.prev=1,e.next=4,ne(t.username);case 4:n=e.sent,f(n.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:e.next=23;break;case 13:return e.prev=13,e.next=16,te(null===x||void 0===x?void 0:x._id);case 16:c=e.sent,f(c.data),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(13),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[1,8],[13,20]])})));return function(){return e.apply(this,arguments)}})()()}),[null===x||void 0===x?void 0:x._id,t]);var S=function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{k?ce(t._id,x._id).then((function(e){y.b.success("User has been unfollowed."),v({type:"UNFOLLOW",payload:t._id})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")})):re(t._id,x._id).then((function(e){y.b.success("User has been followed."),v({type:"FOLLOW",payload:t._id})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")})),I(!k)}catch(n){}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{className:"rightbarAd",src:"assets/ad.png",alt:""}),(null===n||void 0===n?void 0:n.length)>0&&Object(A.jsx)("h4",{className:"rightbarTitle",children:"Online Friends"}),Object(A.jsx)("ul",{className:"rightbarFriendList",children:s?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})):null===n||void 0===n?void 0:n.map((function(e){return Object(A.jsx)("div",{onClick:function(){return O.push("/messenger?q=".concat(e._id))},style:{cursor:"pointer"},children:Object(A.jsx)(me,{user:e},e._id)},e._id)}))})]})},L=function(){var e=Object(c.useState)(!1),n=Object(i.a)(e,2),r=n[0],s=n[1],o=function(){return s(!1)};return Object(A.jsxs)(A.Fragment,{children:[u?Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"d-flex align-items-center pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{width:200,count:2})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{height:36})})]}),Object(A.jsx)(E.a,{count:3,width:200}),Object(A.jsx)(E.a,{count:6})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("div",{className:"d-flex align-items-center",children:[t.username!==x.username&&Object(A.jsxs)("button",{className:"rightbarFollowButton",onClick:S,children:[k?"Unfollow":"Follow",k?Object(A.jsx)(Fe.a,{}):Object(A.jsx)(Re.a,{})]}),k&&Object(A.jsx)("button",{className:"rightbarFollowButton ms-3",onClick:function(){return O.push("/messenger?q=".concat(null===t||void 0===t?void 0:t._id))},title:"Send Message",children:Object(A.jsx)(j.a,{})})]}),Object(A.jsxs)("div",{className:"profileEditContainer",children:[Object(A.jsxs)("div",{className:"d-flex flex-column",children:[Object(A.jsx)("h4",{className:"profileInfoName",children:Object(A.jsx)("strong",{children:t.username&&"@".concat(t.username)})}),Object(A.jsx)("h4",{className:"rightbarTitle",children:"User information"})]}),t.username===x.username&&Object(A.jsxs)("button",{className:"editButton",onClick:function(){return s(!0)},children:[Object(A.jsx)(De.a,{}),"Edit profile"]})]}),Object(A.jsxs)("div",{className:"rightbarInfo",children:[Object(A.jsxs)("div",{className:"rightbarInfoItem",children:[Object(A.jsx)("span",{className:"rightbarInfoKey",children:"First Name:"}),Object(A.jsx)("span",{className:"rightbarInfoValue",children:t.firstName||"N/A"})]}),Object(A.jsxs)("div",{className:"rightbarInfoItem",children:[Object(A.jsx)("span",{className:"rightbarInfoKey",children:"Last Name:"}),Object(A.jsx)("span",{className:"rightbarInfoValue",children:t.lastName||"N/A"})]}),Object(A.jsxs)("div",{className:"rightbarInfoItem",children:[Object(A.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(A.jsx)("span",{className:"rightbarInfoValue",children:t.city||"N/A"})]})]}),Object(A.jsx)("h4",{className:"rightbarTitle",children:"User friends"}),Object(A.jsx)("div",{className:"rightbarFollowings",children:p.map((function(e){return Object(A.jsx)(w.b,{to:"/profile/"+e.username,style:{textDecoration:"none"},children:Object(A.jsxs)("div",{className:"rightbarFollowing",children:[Object(A.jsx)("img",{src:e.profilePicture?e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(A.jsx)("span",{className:"rightbarFollowingName text-center",children:e.username})]})},e.username)}))})]}),Object(A.jsx)(ze,{show:r,user:t,handleClose:o,handleSubmit:function(e){try{a(e,(function(e){e||o()}))}catch(t){console.log(t)}}})]})};return Object(A.jsx)("div",{className:d?"rightbarMobile":"rightbar",children:Object(A.jsx)("div",{className:"rightbarWrapper",children:t?Object(A.jsx)(L,{}):Object(A.jsx)(_,{})})})}n(813);function Ve(){var e=Object(N.g)(),t=Object(c.useContext)(U).user,n=Object(c.useContext)(fe).onlineUsers,r=Object(c.useState)([]),a=Object(i.a)(r,2),s=a[0],o=a[1],l=Object(c.useState)([]),u=Object(i.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)(!0),h=Object(i.a)(b,2),p=h[0],f=h[1];return Object(c.useEffect)((function(){t||e.push("/")}),[t,e]),Object(c.useEffect)((function(){f(!0),te(t._id).then((function(e){o(e.data),f(!1)})).catch((function(e){console.log(e),f(!1)}))}),[t]),Object(c.useEffect)((function(){d(s.filter((function(e){return null===n||void 0===n?void 0:n.includes(e._id)})))}),[n,s]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(ge,{}),Object(A.jsxs)("div",{className:"homeContainer",children:[Object(A.jsx)(ye,{}),Object(A.jsx)(Ue,{}),Object(A.jsx)(Ge,{onlineFriends:j,friends:s,loadingFriends:p})]})]})}n(814);var qe=n(878);function Je(){var e=Object(N.g)(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useContext)(U),a=r.isFetching,s=r.dispatch;return Object(A.jsx)("div",{className:"login",children:Object(A.jsxs)("div",{className:"loginWrapper row align-items-center",children:[Object(A.jsxs)("div",{className:"loginLeft col-md-6",children:[Object(A.jsx)("h3",{className:"loginLogo",children:"Lamasocial"}),Object(A.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on Lamasocial."})]}),Object(A.jsx)("div",{className:"loginRight col-md-6",children:Object(A.jsxs)("form",{className:"loginBox",onSubmit:function(e){e.preventDefault(),Q({email:t.current.value,password:n.current.value},s)},children:[Object(A.jsx)("input",{placeholder:"Email",type:"email",name:"email",required:!0,className:"loginInput",ref:t}),Object(A.jsx)("input",{placeholder:"Password",type:"password",name:"password",required:!0,minLength:"6",className:"loginInput",ref:n}),Object(A.jsx)("button",{className:"loginButton",type:"submit",disabled:a,children:a?Object(A.jsx)(qe.a,{color:"white",size:"20px"}):"Log In"}),Object(A.jsx)("button",{className:"loginRegisterButton",onClick:function(){return e.push("/")},disabled:a,children:a?Object(A.jsx)(qe.a,{color:"white",size:"20px"}):"Create a New Account"})]})})]})})}n(815);var Ye=n(880),Xe=n(879);function Qe(){var e=Object(c.useState)({}),t=Object(i.a)(e,2),n=t[0],r=t[1],a=be(),s=Object(c.useContext)(U),o=s.user,u=s.dispatch,j=Object(c.useState)({coverPicture:!1,profilePicture:!1}),d=Object(i.a)(j,2),b=d[0],h=d[1],p=Object(c.useState)(!1),f=Object(i.a)(p,2),O=f[0],m=f[1],x=Object(c.useState)([]),v=Object(i.a)(x,2),g=v[0],w=v[1],C=Object(N.i)().username;Object(c.useEffect)((function(){m(!0),function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ee(C).then((function(e){r(e.data)})).catch((function(e){return console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),m(!1)}),[C]),Object(c.useEffect)((function(){te(o._id).then((function(e){w(e.data)})).catch((function(e){return console.log(e)}))}),[o._id]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return[ae(Object(l.a)(Object(l.a)({},e),{},{userId:n._id})).then((function(e){var n;t(!1,e),r(e.data.data),u({type:"UPDATE",payload:e.data.data}),h({coverPicture:!1,profilePicture:!1}),y.b.success((null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||"Profile updated successfully.")})).catch((function(e){console.log(e)}))]},I=function(e,t){Ae(e,(function(e,n){e?y.b.error((null===e||void 0===e?void 0:e.message)||"Something went wrong!"):(h(Object(l.a)(Object(l.a)({},b),{},Object(Be.a)({},t,!0))),k(Object(l.a)(Object(l.a)({},o),{},Object(Be.a)({},t,n))))}))};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(ge,{}),Object(A.jsxs)("div",{className:"profile",children:[Object(A.jsx)(ye,{friends:g}),Object(A.jsxs)("div",{className:"profileRight",children:[Object(A.jsx)("div",{className:"profileRightTop",children:Object(A.jsxs)("div",{className:"profileCover",children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("img",{className:"profileCoverImg",src:n.coverPicture?n.coverPicture.replace("s3.ap-south-1.amazonaws.com/social-app-assets","d225jocw4xhwve.cloudfront.net"):"https://d225jocw4xhwve.cloudfront.net/pexels-lina-kivaka-2337491.jpg",alt:""}),b.coverPicture&&Object(A.jsx)(Xe.a,{animation:"border",variant:"primary"}),n.username===o.username&&Object(A.jsx)("div",{children:Object(A.jsxs)("label",{htmlFor:"cover",className:"shareOption",children:[Object(A.jsxs)("div",{className:"editCoverImage",children:[Object(A.jsx)(De.a,{}),a>510&&"Edit Cover Photo"]}),Object(A.jsx)("input",{style:{display:"none"},type:"file",id:"cover",accept:".png,.jpeg,.jpg",onChange:function(e){return I(e.target.files[0],"coverPicture")}})]})})]}),Object(A.jsxs)("div",{className:"profileUserImgContainer",children:[b.profilePicture?Object(A.jsx)(Xe.a,{animation:"border",className:"profileUserImg",variant:"primary"}):Object(A.jsx)("img",{className:"profileUserImg",src:n.profilePicture?n.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:""}),n.username===o.username&&Object(A.jsx)("div",{children:Object(A.jsxs)("label",{htmlFor:"file",className:"shareOption",children:[Object(A.jsx)("div",{className:"editProfileImage",children:Object(A.jsx)(Ye.a,{style:{fontSize:"20px"}})}),Object(A.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return I(e.target.files[0],"profilePicture")}})]})})]})]})}),Object(A.jsx)(Ge,{user:n,UpdateUserDetails:k,loadingUserDetails:O,mobileView:!0}),Object(A.jsxs)("div",{className:"profileRightBottom",children:[Object(A.jsx)(Ue,{username:C,user:n}),Object(A.jsx)(Ge,{user:n,UpdateUserDetails:k,loadingUserDetails:O})]})]})]})]})}n(816);var Ze=function(){var e=Object(z.a)(H.a.mark((function e(){var t,n,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]);case 2:return t=e.sent,e.next=5,window.crypto.subtle.exportKey("jwk",t.publicKey);case 5:return n=e.sent,e.next=8,window.crypto.subtle.exportKey("jwk",t.privateKey);case 8:return c=e.sent,e.abrupt("return",{publicKeyJwk:n,privateKeyJwk:c});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=Object(z.a)(H.a.mark((function e(t,n){var c,r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.importKey("jwk",t,{name:"ECDH",namedCurve:"P-256"},!0,[]);case 2:return c=e.sent,e.next=5,window.crypto.subtle.importKey("jwk",n,{name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]);case 5:return r=e.sent,e.next=8,window.crypto.subtle.deriveKey({name:"ECDH",public:c},r,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(){var e=Object(z.a)(H.a.mark((function e(t,n){var c,r,a,s,i;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(new TextEncoder).encode(t),e.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:(new TextEncoder).encode("Initialization Vector")},n,c);case 3:return r=e.sent,a=new Uint8Array(r),s=String.fromCharCode.apply(null,a),i=btoa(s),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),tt=function(){var e=Object(z.a)(H.a.mark((function e(t,n){var c,r,a,s;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=atob(t),r=new Uint8Array(Object(o.a)(c).map((function(e){return e.charCodeAt(0)}))),a={name:"AES-GCM",iv:(new TextEncoder).encode("Initialization Vector")},e.next=6,window.crypto.subtle.decrypt(a,n,r);case 6:return s=e.sent,e.abrupt("return",(new TextDecoder).decode(s));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return","error decrypting message: ".concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}();function nt(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(N.g)(),s=Object(c.useContext)(U),i=s.dispatch,o=s.isFetching,u=function(){var c=Object(z.a)(H.a.mark((function c(s){var o,u;return H.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(s.preventDefault(),r.current.value===n.current.value){c.next=5;break}y.b.warning("Passwords don't match!"),c.next=10;break;case 5:return c.next=7,Ze();case 7:o=c.sent,u=Object(l.a)({username:e.current.value,email:t.current.value,password:n.current.value},o),Z(u,i).then((function(e){y.b.success("Registration done successfully. Please login to continue."),a.push("/login")})).catch((function(e){var t;console.log(e),y.b.error((null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)||"Something went wrong!")}));case 10:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}();return Object(A.jsx)("div",{className:"login",children:Object(A.jsxs)("div",{className:"loginWrapper row align-items-center",children:[Object(A.jsxs)("div",{className:"loginLeft col-md-6",children:[Object(A.jsx)("h3",{className:"loginLogo",children:"Lamasocial"}),Object(A.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on Lamasocial."})]}),Object(A.jsx)("div",{className:"loginRight col-md-6",children:Object(A.jsxs)("form",{className:"loginBox",onSubmit:u,children:[Object(A.jsx)("input",{placeholder:"Username",required:!0,ref:e,name:"username",className:"loginInput"}),Object(A.jsx)("input",{placeholder:"Email",required:!0,ref:t,name:"email",className:"loginInput",type:"email"}),Object(A.jsx)("input",{placeholder:"Password",required:!0,ref:n,name:"password",className:"loginInput",type:"password",minLength:"6"}),Object(A.jsx)("input",{placeholder:"Confirm Password",required:!0,ref:r,name:"passwordAgain",className:"loginInput",type:"password"}),Object(A.jsx)("button",{className:"loginButton",type:"submit",disabled:o,children:o?Object(A.jsx)(qe.a,{color:"white",size:"20px"}):"Sign Up"}),Object(A.jsx)("button",{className:"loginRegisterButton",onClick:function(){return a.push("/login")},disabled:o,children:o?Object(A.jsx)(qe.a,{color:"white",size:"20px"}):"Log into Account"})]})})]})})}n(817),n(818);var ct=function(e){var t=e.conversation,n=e.currentUser,r=e.setAllConversations,a=e.AllConversations,s=Object(c.useState)(null),o=Object(i.a)(s,2),l=o[0],u=o[1];return Object(c.useEffect)((function(){var e,c=null===(e=t.members)||void 0===e?void 0:e.find((function(e){return e!==n._id}));$(c).then((function(e){u(e.data);var t=a.map((function(t){return t.members.includes(e.data._id)&&(t.member=e.data),t}));r(t)})).catch((function(e){console.log(e)}))}),[n,t]),Object(A.jsxs)("div",{className:"conversation",children:[Object(A.jsx)("img",{className:"conversationImg",src:(null===l||void 0===l?void 0:l.profilePicture)?null===l||void 0===l?void 0:l.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(A.jsx)("span",{className:"conversationName",children:null===l||void 0===l?void 0:l.username})]})},rt=(n(819),function(e){var t=e.message,n=e.own,a=e.Decrypt,s=e.derivedKeys,o=e.friend,l=e.encryptMessages,u=r.a.useState(""),j=Object(i.a)(u,2),d=j[0],b=j[1],h=Object(c.useContext)(U).user;return r.a.useEffect((function(){(function(){var e=Object(z.a)(H.a.mark((function e(){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t.text,s);case 2:n=e.sent,b(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,s]),Object(A.jsxs)("div",{className:"message".concat(n?" own":""),children:[Object(A.jsxs)("div",{className:"messageTop",children:[Object(A.jsx)("img",{className:"messageImg",src:n?(null===h||void 0===h?void 0:h.profilePicture)?null===h||void 0===h?void 0:h.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png":(null===o||void 0===o?void 0:o.profilePicture)?null===o||void 0===o?void 0:o.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(A.jsx)("p",{className:"messageText",children:l?t.text:d})]}),Object(A.jsx)("div",{className:"messageBottom",children:Object(ke.a)(t.createdAt)})]})}),at=(n(820),function(e){var t=e.onlineUsers,n=e.currentId,r=e.setCurrentChat,a=e.updateConversations,s=void 0===a?function(){}:a,l=Object(c.useState)([]),u=Object(i.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)([]),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(c.useState)(!0),m=Object(i.a)(O,2),x=m[0],v=m[1];Object(c.useEffect)((function(){v(!0),te(n).then((function(e){d(e.data),v(!1)})).catch((function(e){console.log(e),v(!1)}))}),[n]),Object(c.useEffect)((function(){f(j.filter((function(e){return null===t||void 0===t?void 0:t.includes(e._id)})))}),[t,j]);return Object(A.jsx)("div",{className:"chatOnline",children:x?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})):j.length>0?j.map((function(e,t){return Object(A.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return t=e._id,void le(n,t).then((function(e){e.data.new&&s({senderId:n,receiverId:t,conversation:e.data.data}),r(e.data.data)})).catch((function(e){console.log(e)}));var t},children:[Object(A.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(A.jsx)("img",{className:"chatOnlineImg",src:(null===e||void 0===e?void 0:e.profilePicture)?null===e||void 0===e?void 0:e.profilePicture:"https://d225jocw4xhwve.cloudfront.net/person/noAvatar.png",alt:"profileImage"}),Object(A.jsx)("div",{className:"chatOnlineBadge".concat((c=e._id,p.some((function(e){return e._id===c}))?" online":""))})]}),Object(A.jsx)("span",{className:"chatOnlineName",children:e.username})]},t);var c})):Object(A.jsx)("span",{className:"noChatText",children:"You don't have any friends yet."})})}),st=n(277),it=n.n(st),ot=n(278),lt=n.n(ot),ut=function(){var e,t=ve().socket,n=Object(c.useState)([]),r=Object(i.a)(n,2),a=r[0],s=r[1],l=Object(c.useState)([]),u=Object(i.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)(null),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(c.useState)([]),m=Object(i.a)(O,2),x=m[0],g=m[1],w=Object(c.useState)(null),C=Object(i.a)(w,2),S=C[0],_=C[1],L=Object(c.useState)(""),P=Object(i.a)(L,2),T=P[0],F=P[1],R=Object(c.useState)(),D=Object(i.a)(R,2),B=D[0],M=D[1],K=Object(c.useState)(!1),W=Object(i.a)(K,2),G=W[0],V=W[1],q=Object(c.useState)(!1),J=Object(i.a)(q,2),Y=J[0],X=J[1],Q=Object(c.useState)(!1),Z=Object(i.a)(Q,2),ee=Z[0],te=Z[1],ne=Object(c.useContext)(U).user,ce=be(),re=Object(c.useContext)(fe),ae=re.onlineUsers,ue=re.arrivalMessage,je=re.newConversation,de=Object(c.useRef)(),he=null===(e=Object(N.h)().search)||void 0===e?void 0:e.split("=")[1];Object(c.useEffect)((function(){ue&&(null===p||void 0===p?void 0:p.members.includes(ue.sender))&&g((function(e){return[].concat(Object(o.a)(e),[ue])}))}),[ue,p]),Object(c.useEffect)((function(){if(je){var e=je.conversation;d((function(t){return[].concat(Object(o.a)(t),[e])})),s((function(t){return[].concat(Object(o.a)(t),[e])}))}}),[je]),Object(c.useEffect)((function(){V(!0),se(ne._id).then((function(e){s(e.data),d(e.data),V(!1)})).catch((function(e){console.log(e),V(!1),y.b.error("Something went wrong!")}))}),[ne._id]),Object(c.useEffect)((function(){var e;(X(!0),p)&&$(null===p||void 0===p||null===(e=p.members)||void 0===e?void 0:e.find((function(e){return e!==ne._id}))).then((function(e){_(e.data)})).catch((function(e){return console.log(e)}));ie(null===p||void 0===p?void 0:p._id).then((function(e){g(e.data),X(!1)})).catch((function(e){console.log(e),X(!1),y.b.error("Something went wrong!")}))}),[p,ne]),Object(c.useEffect)((function(){$e(null===S||void 0===S?void 0:S.publicKeyJwk,null===ne||void 0===ne?void 0:ne.privateKeyJwk).then((function(e){M(e)}))}),[S,ne]);var pe=function(){var e=Object(z.a)(H.a.mark((function e(n){var c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,et(T,B);case 3:c=e.sent,T&&oe({conversationId:p._id,sender:ne._id,text:c}).then((function(e){var n;F(""),g([].concat(Object(o.a)(x),[e.data]));var r=null===(n=p.members)||void 0===n?void 0:n.find((function(e){return e!==ne._id}));t.current.emit("sendMessage",{senderId:ne._id,receiverId:r,text:c})})).catch((function(e){console.log(e),y.b.error("Something went wrong!")}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;null===(e=de.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[x]);var Oe=function(e){t.current.emit("addConversation",e)};return Object(c.useEffect)((function(){he&&le(ne._id,he).then((function(e){e.data.new&&Oe({senderId:ne._id,receiverId:he,conversation:e.data.data}),f(e.data.data)})).catch((function(e){console.log(e)}))}),[he,ne]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(ge,{}),Object(A.jsxs)("div",{className:"messenger ".concat(ce<783?"messengerMobile":""),children:[Object(A.jsx)("div",{className:"chatMenu ".concat(ce<783&&!p?"chatMenuMobile":""),children:Object(A.jsxs)("div",{className:"chatMenuWrapper",children:[Object(A.jsx)("h5",{className:"sectionTitle",children:"Your recent conversations"}),Object(A.jsx)("input",{type:"text",placeholder:"Search for friends",className:"chatMenuInput",onChange:function(e){V(!0);var t=e.target.value;if(""===t)d(a);else{var n=a.filter((function(e){var n;return(null===e||void 0===e||null===(n=e.member)||void 0===n?void 0:n.username.toLocaleLowerCase().includes(t.toLocaleLowerCase()))?e:0}));d(n)}V(!1)}}),G?Object(o.a)(Array(3).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2",children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})):j.length>0?j.map((function(e,t){return Object(A.jsx)("div",{onClick:function(){return f(e)},children:Object(A.jsx)(ct,{AllConversations:a,setAllConversations:s,conversation:e,currentUser:ne})},t)})):Object(A.jsx)("span",{className:"noChatText",children:"You don't have any conversations yet."})]})}),Object(A.jsx)("div",{className:"chatBox ".concat(ce<783&&p?"chatBoxMobile":""),children:Object(A.jsxs)("div",{className:"chatBoxWrapper",children:[p&&Object(A.jsxs)("div",{className:"chatBoxHeader d-flex justify-content-between align-items-center",children:[Object(A.jsx)(v.a,{onClick:function(){return f(null)},children:Object(A.jsx)(it.a,{style:{color:"#5e5e5e",fontSize:28}})}),Object(A.jsx)(k.a,{overlayStyle:{whiteSpace:"pre-line",fontSize:13},title:"Enable this if you want to see the encrypt message",placement:"bottom",children:Object(A.jsx)(I.a,{onChange:function(e){return te(e)}})})]}),p?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("div",{className:"chatBoxTop",children:[Y&&Object(o.a)(Array(6).keys()).map((function(e,t){return Object(A.jsxs)("div",{className:"d-flex align-items-center ps-2 pe-3 py-2 w-50 ".concat(t%2===0?"ms-auto":""),children:[Object(A.jsx)("div",{children:Object(A.jsx)(E.a,{circle:!0,width:40,height:40})}),Object(A.jsx)("div",{className:"w-100 ps-3",children:Object(A.jsx)(E.a,{count:3})})]},t)})),x.length>0?x.map((function(e,t){return Object(A.jsx)("div",{ref:de,children:Object(A.jsx)(rt,{encryptMessages:ee,derivedKeys:B,Decrypt:tt,message:e,friend:S,own:e.sender===ne._id})},t)})):Object(A.jsx)("span",{className:"noConversationText",children:!Y&&"Write your first message to ".concat(null===S||void 0===S?void 0:S.username,"...")})]}),Object(A.jsxs)("div",{className:"chatBoxBottom",children:[Object(A.jsx)("textarea",{className:"chatMessageInput",placeholder:"Write something...",onChange:function(e){return F(e.target.value)},value:T,rows:1}),Object(A.jsx)("button",{className:"chatSubmitBtn",onClick:pe,children:Object(A.jsx)(lt.a,{style:{color:"#fff"}})})]})]}):Object(A.jsx)("span",{className:"noConversationText",children:"Open a conversation to start a chat."})]})}),Object(A.jsx)("div",{className:"chatOnline",children:Object(A.jsxs)("div",{className:"chatOnlineWrapper",children:[Object(A.jsx)("h5",{className:"sectionTitle",children:"Your friends"}),Object(A.jsx)(at,{onlineUsers:ae,currentId:ne._id,setCurrentChat:f,updateConversations:Oe})]})})]})]})},jt=(n(821),n(881)),dt=n(279),bt=n.n(dt),ht=function(){var e=Object(N.g)(),t=be();return"/messenger"===e.location.pathname&&t<783?null:Object(A.jsx)(jt.a,{color:"primary","aria-label":"add",className:"message-ctaBtn",onClick:function(){return e.push("/messenger")},children:Object(A.jsx)(bt.a,{})})};var pt=function(){var e=Object(c.useContext)(U).user,t=Object(c.useContext)(fe).dispatch,n=Object(c.useContext)(B).theme,r=ve().socket;return Object(c.useEffect)((function(){"dark"===n?(document.body.classList.add("darkTheme"),document.body.classList.remove("lightTheme")):(document.body.classList.remove("darkTheme"),document.body.classList.add("lightTheme"))}),[n]),Object(c.useEffect)((function(){r&&r.current&&r.current.on("getUsers",(function(n){console.log({users:n}),t(function(e){return{type:"SET_ONLINE_USERS",payload:e}}(null===e||void 0===e?void 0:e.followings.filter((function(e){return n.some((function(t){return t.userId===e}))}))))}))}),[e,t,r]),Object(A.jsxs)(w.a,{children:[Object(A.jsxs)(N.d,{children:[Object(A.jsx)(N.b,{exact:!0,path:"/",children:e?Object(A.jsx)(Ve,{}):Object(A.jsx)(nt,{})}),Object(A.jsx)(N.b,{path:"/login",children:e?Object(A.jsx)(N.a,{to:"/"}):Object(A.jsx)(Je,{})}),Object(A.jsx)(N.b,{path:"/register",children:e?Object(A.jsx)(N.a,{to:"/"}):Object(A.jsx)(nt,{})}),Object(A.jsx)(N.b,{path:"/messenger",children:e?Object(A.jsx)(ut,{}):Object(A.jsx)(N.a,{to:"/"})}),Object(A.jsx)(N.b,{path:"/profile/:username",children:e?Object(A.jsx)(Qe,{}):Object(A.jsx)(N.a,{to:"/"})})]}),e&&Object(A.jsx)(ht,{})]})};n(822),n(823),n(824),n(825);s.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(F,{children:Object(A.jsx)(Oe,{children:Object(A.jsx)(M,{children:Object(A.jsx)(pt,{})})})})}),document.getElementById("root"))}},[[826,1,2]]]);
//# sourceMappingURL=main.a3214ec8.chunk.js.map